(function(){"use strict";function Je(){const e=document.getElementsByTagName("script"),t=e[e.length-1];try{const n=t.src;if(n.includes("://")){const o=new URL(n).pathname.split("/");return o.pop(),o[o.length-1]==="js"&&o[o.length-2]==="assets"?(o.pop(),o.pop()):o[o.length-1]==="assets"&&o.pop(),o.join("/")+"/"}else{const a=n.split("/");return a.pop(),a.length>=2&&a[a.length-1]==="js"&&a[a.length-2]==="assets"?(a.pop(),a.pop()):a.length>=1&&a[a.length-1]==="assets"&&a.pop(),a.join("/")+"/"}}catch(n){return console.error("Ошибка при определении базового пути:",n),"./"}}function Xe(e){document.readyState!=="loading"?e():document.addEventListener("DOMContentLoaded",e)}function bn(e,t){const n=document.createElement("script");n.src=e,n.onload=()=>{t&&t(null)},n.onerror=()=>{t&&t(new Error(`Не удалось загрузить скрипт: ${e}`))},document.head.appendChild(n)}function wn(e,t){const n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onload=()=>{t&&t(null)},n.onerror=()=>{t&&t(new Error(`Не удалось загрузить стиль: ${e}`))},document.head.appendChild(n)}function Qe(){return window.innerWidth<768?"mobile":"desktop"}class xn{constructor(t){this.input=t,this.init()}init(){this.input.placeholder="+7 (___) ___-__-__",this.input.addEventListener("blur",this.onBlur.bind(this)),this.input.addEventListener("input",this.onInput.bind(this))}onInput(t){const n=/[\d\+\-\(\) ]/g;let a=this.input.value.match(n);a?this.input.value=a.join(""):this.input.value="",this.input.setCustomValidity("")}onBlur(t){let n=this.input.value.replace(/[^\d\+]/g,"");if(n.startsWith("8")&&(n="+7"+n.slice(1)),n.startsWith("+7")&&n.length===12){const a=n.replace(/\D/g,"");this.input.value=`+7 (${a.slice(1,4)}) ${a.slice(4,7)}-${a.slice(7,9)}-${a.slice(9,11)}`,this.input.setCustomValidity("");return}this.input.setCustomValidity("Введите корректный номер телефона")}}class En{constructor(){this.activeModal=null,this.init()}init(){this.bindGlobalEvents()}bindGlobalEvents(){document.addEventListener("keydown",t=>{t.key==="Escape"&&this.activeModal&&this.close(this.activeModal)}),document.addEventListener("click",t=>{t.target.classList.contains("modal-backdrop")&&this.activeModal&&this.close(this.activeModal)}),document.addEventListener("click",t=>{t.target.closest(".modal-close")&&this.activeModal&&this.close(this.activeModal)})}open(t,n={}){const a=typeof t=="string"?document.getElementById(t):t;if(!a){console.error("Модальное окно не найдено:",t);return}this.activeModal&&this.activeModal!==a&&this.close(this.activeModal),this.activeModal=a,a.classList.add("modal-open"),document.body.style.overflow="hidden",a.focus(),n.onOpen&&n.onOpen(a),console.log("Модальное окно открыто:",a.id)}close(t,n={}){const a=typeof t=="string"?document.getElementById(t):t;if(!a){console.error("Модальное окно не найдено:",t);return}a.classList.remove("modal-open"),document.body.style.overflow="",this.activeModal===a&&(this.activeModal=null),n.onClose&&n.onClose(a),console.log("Модальное окно закрыто:",a.id)}create(t={}){const{id:n="dynamic-modal",title:a="",content:o="",size:i="default",showCloseButton:r=!0,backdrop:s=!0,onOpen:l=null,onClose:d=null}=t,u=document.getElementById(n);u&&u.remove();let h="";switch(i){case"small":h="max-w-md";break;case"large":h="max-w-4xl";break;case"full":h="max-w-full w-full h-full";break;default:h="max-w-2xl"}const c=`
      <div id="${n}" class="modal">
        ${s?'<div class="modal-backdrop"></div>':""}
        <div class="modal-box ${h} bg-brand-light">
          ${r?`
            <button class="modal-close absolute right-4 top-4 bg-white rounded-full w-8 h-8 flex items-center justify-center shadow" aria-label="Закрыть">
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 6l8 8M6 14L14 6" stroke-linecap="round"/></svg>
            </button>
          `:""}
          ${a?`<h3 class="font-bold text-lg mb-4">${a}</h3>`:""}
          <div class="modal-content">
            ${o}
          </div>
        </div>
      </div>
    `;document.body.insertAdjacentHTML("beforeend",c);const m=document.getElementById(n);return this.open(m,{onOpen:l,onClose:d}),m}updateContent(t,n){const a=typeof t=="string"?document.getElementById(t):t;if(!a){console.error("Модальное окно не найдено:",t);return}const o=a.querySelector(".modal-content");o&&(o.innerHTML=n)}isOpen(t){const n=typeof t=="string"?document.getElementById(t):t;return n&&n.classList.contains("modal-open")}closeAll(){document.querySelectorAll(".modal.modal-open").forEach(n=>this.close(n))}}const I=new En;window.modalManager=I;class et{constructor(){this.loginModal=document.getElementById("login-modal"),this.loginForm=document.getElementById("login-form"),this.basePath=Je(),this.init()}init(){!this.loginModal||!this.loginForm||(document.addEventListener("click",t=>{t.target.closest('#mobile-menu-login, a[href*="profile.html"]')&&(t.preventDefault(),modalManager.open(this.loginModal))}),this.loginForm.addEventListener("submit",t=>{t.preventDefault();const n=document.getElementById("login-email").value,a=document.getElementById("login-password").value;n==="test@aeroline.su"&&a==="password123"?(modalManager.close(this.loginModal),window.location.href=`${this.basePath}profile.html`):alert("Неверный email или пароль")}))}}document.addEventListener("DOMContentLoaded",()=>{new et});/*! name: vanilla-calendar-pro v3.0.4 | url: https://github.com/uvarov-frontend/vanilla-calendar-pro */var Dn=Object.defineProperty,Mn=Object.defineProperties,Cn=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertySymbols,Sn=Object.prototype.hasOwnProperty,kn=Object.prototype.propertyIsEnumerable,ve=(e,t,n)=>t in e?Dn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,V=(e,t)=>{for(var n in t||(t={}))Sn.call(t,n)&&ve(e,n,t[n]);if(tt)for(var n of tt(t))kn.call(t,n)&&ve(e,n,t[n]);return e},In=(e,t)=>Mn(e,Cn(t)),b=(e,t,n)=>(ve(e,typeof t!="symbol"?t+"":t,n),n);const B={notFoundSelector:e=>`${e} is not found, check the first argument passed to new Calendar.`,notInit:'The calendar has not been initialized, please initialize it using the "init()" method first.',notLocale:"You specified an incorrect language label or did not specify the required number of values ​​for «locale.weekdays» or «locale.months».",incorrectTime:"The value of the time property can be: false, 12 or 24.",incorrectMonthsCount:"For the «multiple» calendar type, the «displayMonthsCount» parameter can have a value from 2 to 12, and for all others it cannot be greater than 1."},x=(e,t,n)=>{e.context[t]=n},Ln=e=>{var t,n,a,o,i;if(!e.context.isInit)throw new Error(B.notInit);e.inputMode?((t=e.context.mainElement.parentElement)==null||t.removeChild(e.context.mainElement),(a=(n=e.context.inputElement)==null?void 0:n.replaceWith)==null||a.call(n,e.context.originalElement),x(e,"inputElement",void 0)):(i=(o=e.context.mainElement).replaceWith)==null||i.call(o,e.context.originalElement),x(e,"mainElement",e.context.originalElement),e.onDestroy&&e.onDestroy(e)},ye=e=>{e.context.isShowInInputMode&&e.context.currentType&&(e.context.mainElement.dataset.vcCalendarHidden="",x(e,"isShowInInputMode",!1),e.context.cleanupHandlers[0]&&(e.context.cleanupHandlers.forEach(t=>t()),x(e,"cleanupHandlers",[])),e.onHide&&e.onHide(e))};function be(e){if(!e||!e.getBoundingClientRect)return{top:0,bottom:0,left:0,right:0};const t=e.getBoundingClientRect(),n=document.documentElement;return{bottom:t.bottom,right:t.right,top:t.top+window.scrollY-n.clientTop,left:t.left+window.scrollX-n.clientLeft}}function we(){return{vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}function Pn(){return{left:window.scrollX||document.documentElement.scrollLeft||0,top:window.scrollY||document.documentElement.scrollTop||0}}function An(e){const{top:t,left:n}=Pn(),{top:a,left:o}=be(e),{vh:i,vw:r}=we(),s=a-t,l=o-n;return{top:s,bottom:i-(s+e.clientHeight),left:l,right:r-(l+e.clientWidth)}}function nt(e,t,n=5){const a={top:!0,bottom:!0,left:!0,right:!0},o=[];if(!t||!e)return{canShow:a,parentPositions:o};const{bottom:i,top:r}=An(e),{top:s,left:l}=be(e),{height:d,width:u}=t.getBoundingClientRect(),{vh:h,vw:c}=we(),m=c/2,f=h/2;return[{condition:s<f,position:"top"},{condition:s>f,position:"bottom"},{condition:l<m,position:"left"},{condition:l>m,position:"right"}].forEach(({condition:y,position:E})=>{y&&o.push(E)}),Object.assign(a,{top:d<=r-n,bottom:d<=i-n,left:u<=l,right:u<=c-l}),{canShow:a,parentPositions:o}}const Tn=(e,t,n,a)=>{var o;const i=a.querySelector(`[data-vc-date="${t}"]`),r=i==null?void 0:i.querySelector("[data-vc-date-btn]");if(!i||!r||(n!=null&&n.modifier&&r.classList.add(...n.modifier.trim().split(" ")),!(n!=null&&n.html)))return;const s=document.createElement("div");s.className=e.styles.datePopup,s.dataset.vcDatePopup="",s.innerHTML=e.sanitizerHTML(n.html),r.ariaExpanded="true",r.ariaLabel=`${r.ariaLabel}, ${(o=s==null?void 0:s.textContent)==null?void 0:o.replace(/^\s+|\s+(?=\s)|\s+$/g,"").replace(/&nbsp;/g," ")}`,i.appendChild(s),requestAnimationFrame(()=>{if(!s)return;const{canShow:l}=nt(i,s),d=l.bottom?i.offsetHeight:-s.offsetHeight,u=l.left&&!l.right?i.offsetWidth-s.offsetWidth/2:!l.left&&l.right?s.offsetWidth/2:0;Object.assign(s.style,{left:`${u}px`,top:`${d}px`})})},qn=(e,t)=>{var n;e.popups&&((n=Object.entries(e.popups))==null||n.forEach(([a,o])=>Tn(e,a,o,t)))},M=e=>new Date(`${e}T00:00:00`),O=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,R=e=>e.reduce((t,n)=>{if(n instanceof Date||typeof n=="number"){const a=n instanceof Date?n:new Date(n);t.push(a.toISOString().substring(0,10))}else n.match(/^(\d{4}-\d{2}-\d{2})$/g)?t.push(n):n.replace(/(\d{4}-\d{2}-\d{2}).*?(\d{4}-\d{2}-\d{2})/g,(a,o,i)=>{const r=M(o),s=M(i),l=new Date(r.getTime());for(;l<=s;l.setDate(l.getDate()+1))t.push(O(l));return a});return t},[]),N=(e,t,n,a="")=>{t?e.setAttribute(n,a):e.getAttribute(n)===a&&e.removeAttribute(n)},at=(e,t,n,a,o,i,r)=>{var s,l,d,u;const h=M(e.context.displayDateMin)>M(i)||M(e.context.displayDateMax)<M(i)||((s=e.context.disableDates)==null?void 0:s.includes(i))||!e.selectionMonthsMode&&r!=="current"||!e.selectionYearsMode&&M(i).getFullYear()!==t;N(n,h,"data-vc-date-disabled"),a&&N(a,h,"aria-disabled","true"),a&&N(a,h,"tabindex","-1"),N(n,!e.disableToday&&e.context.dateToday===i,"data-vc-date-today"),N(n,!e.disableToday&&e.context.dateToday===i,"aria-current","date"),N(n,(l=e.selectedWeekends)==null?void 0:l.includes(o),"data-vc-date-weekend");const c=(d=e.selectedHolidays)!=null&&d[0]?R(e.selectedHolidays):[];if(N(n,c.includes(i),"data-vc-date-holiday"),(u=e.context.selectedDates)!=null&&u.includes(i)?(n.setAttribute("data-vc-date-selected",""),a&&a.setAttribute("aria-selected","true"),e.context.selectedDates.length>1&&e.selectionDatesMode==="multiple-ranged"&&(e.context.selectedDates[0]===i&&e.context.selectedDates[e.context.selectedDates.length-1]===i?n.setAttribute("data-vc-date-selected","first-and-last"):e.context.selectedDates[0]===i?n.setAttribute("data-vc-date-selected","first"):e.context.selectedDates[e.context.selectedDates.length-1]===i&&n.setAttribute("data-vc-date-selected","last"),e.context.selectedDates[0]!==i&&e.context.selectedDates[e.context.selectedDates.length-1]!==i&&n.setAttribute("data-vc-date-selected","middle"))):n.hasAttribute("data-vc-date-selected")&&(n.removeAttribute("data-vc-date-selected"),a&&a.removeAttribute("aria-selected")),!e.context.disableDates.includes(i)&&e.enableEdgeDatesOnly&&e.context.selectedDates.length>1&&e.selectionDatesMode==="multiple-ranged"){const m=M(e.context.selectedDates[0]),f=M(e.context.selectedDates[e.context.selectedDates.length-1]),y=M(i);N(n,y>m&&y<f,"data-vc-date-selected","middle")}},$n=(e,t,n)=>new Date(`${e}T00:00:00.000Z`).toLocaleString(t,n),ot=(e,t)=>{const n=M(e),a=(n.getDay()-t+7)%7;n.setDate(n.getDate()+4-a);const o=new Date(n.getFullYear(),0,1),i=Math.ceil(((+n-+o)/864e5+1)/7);return{year:n.getFullYear(),week:i}},Bn=(e,t,n)=>{const a=ot(n,e.firstWeekday);a&&(t.dataset.vcDateWeekNumber=String(a.week))},Nn=(e,t,n)=>{var a,o,i,r,s;const l=(a=e.disableWeekdays)==null?void 0:a.includes(n),d=e.disableAllDates&&!!((o=e.context.enableDates)!=null&&o[0]);!l&&!d||(i=e.context.enableDates)!=null&&i.includes(t)||(r=e.context.disableDates)!=null&&r.includes(t)||(e.context.disableDates.push(t),(s=e.context.disableDates)==null||s.sort((u,h)=>+new Date(u)-+new Date(h)))},xe=(e,t,n,a,o,i)=>{const r=M(o).getDay(),s=typeof e.locale=="string"&&e.locale.length?e.locale:"en",l=document.createElement("div");let d;l.className=e.styles.date,l.dataset.vcDate=o,l.dataset.vcDateMonth=i,l.dataset.vcDateWeekDay=String(r),(i==="current"||e.displayDatesOutside)&&(d=document.createElement("button"),d.className=e.styles.dateBtn,d.type="button",d.role="gridcell",d.ariaLabel=$n(o,s,{dateStyle:"long",timeZone:"UTC"}),d.dataset.vcDateBtn="",d.innerText=String(a),l.appendChild(d)),e.enableWeekNumbers&&Bn(e,l,o),Nn(e,o,r),at(e,t,l,d,r,o,i),n.appendChild(l),e.onCreateDateEls&&e.onCreateDateEls(e,l)},Fn=(e,t,n,a,o)=>{for(let i=1;i<=n;i++){const r=new Date(a,o,i);xe(e,a,t,i,O(r),"current")}},On=(e,t,n,a,o,i)=>{const r=i+n,s=7*Math.ceil(r/7)-r,l=o+1===12?a+1:a,d=o+1===12?"01":o+2<10?`0${o+2}`:o+2;for(let u=1;u<=s;u++){const h=u<10?`0${u}`:String(u);xe(e,a,t,u,`${l}-${d}-${h}`,"next")}},Rn=(e,t,n,a,o)=>{let i=new Date(n,a,0).getDate()-(o-1);const r=a===0?n-1:n,s=a===0?12:a<10?`0${a}`:a;for(let l=o;l>0;l--,i++)xe(e,n,t,i,`${r}-${s}-${i}`,"prev")},Hn=(e,t,n,a,o)=>{if(!e.enableWeekNumbers)return;a.textContent="";const i=document.createElement("b");i.className=e.styles.weekNumbersTitle,i.innerText="#",i.dataset.vcWeekNumbers="title",a.appendChild(i);const r=document.createElement("div");r.className=e.styles.weekNumbersContent,r.dataset.vcWeekNumbers="content",a.appendChild(r);const s=document.createElement("button");s.type="button",s.className=e.styles.weekNumber;const l=o.querySelectorAll("[data-vc-date]"),d=Math.ceil((t+n)/7);for(let u=0;u<d;u++){const h=l[u===0?6:7*u].dataset.vcDate,c=ot(h,e.firstWeekday);if(!c)return;const m=s.cloneNode(!0);m.innerText=String(c.week),m.dataset.vcWeekNumber=String(c.week),m.dataset.vcWeekYear=String(c.year),m.role="rowheader",m.ariaLabel=`${c.week}`,r.appendChild(m)}},Ee=e=>{const t=new Date(e.context.selectedYear,e.context.selectedMonth,1),n=e.context.mainElement.querySelectorAll('[data-vc="dates"]'),a=e.context.mainElement.querySelectorAll('[data-vc-week="numbers"]');n.forEach((o,i)=>{e.selectionDatesMode||(o.dataset.vcDatesDisabled=""),o.textContent="";const r=new Date(t);r.setMonth(r.getMonth()+i);const s=r.getMonth(),l=r.getFullYear(),d=(new Date(l,s,1).getDay()-e.firstWeekday+7)%7,u=new Date(l,s+1,0).getDate();Rn(e,o,l,s,d),Fn(e,o,u,l,s),On(e,o,u,l,s,d),qn(e,o),Hn(e,d,u,a[i],o)})},Yn=e=>`
  <div class="${e.styles.header}" data-vc="header" role="toolbar" aria-label="${e.labels.navigation}">
    <#ArrowPrev [month] />
    <div class="${e.styles.headerContent}" data-vc-header="content">
      <#Month />
      <#Year />
    </div>
    <#ArrowNext [month] />
  </div>
  <div class="${e.styles.wrapper}" data-vc="wrapper">
    <#WeekNumbers />
    <div class="${e.styles.content}" data-vc="content">
      <#Week />
      <#Dates />
      <#DateRangeTooltip />
    </div>
  </div>
  <#ControlTime />
`,_n=e=>`
  <div class="${e.styles.header}" data-vc="header" role="toolbar" aria-label="${e.labels.navigation}">
    <div class="${e.styles.headerContent}" data-vc-header="content">
      <#Month />
      <#Year />
    </div>
  </div>
  <div class="${e.styles.wrapper}" data-vc="wrapper">
    <div class="${e.styles.content}" data-vc="content">
      <#Months />
    </div>
  </div>
`,zn=e=>`
  <div class="${e.styles.controls}" data-vc="controls" role="toolbar" aria-label="${e.labels.navigation}">
    <#ArrowPrev [month] />
    <#ArrowNext [month] />
  </div>
  <div class="${e.styles.grid}" data-vc="grid">
    <#Multiple>
      <div class="${e.styles.column}" data-vc="column" role="region">
        <div class="${e.styles.header}" data-vc="header">
          <div class="${e.styles.headerContent}" data-vc-header="content">
            <#Month />
            <#Year />
          </div>
        </div>
        <div class="${e.styles.wrapper}" data-vc="wrapper">
          <#WeekNumbers />
          <div class="${e.styles.content}" data-vc="content">
            <#Week />
            <#Dates />
          </div>
        </div>
      </div>
    <#/Multiple>
    <#DateRangeTooltip />
  </div>
  <#ControlTime />
`,Wn=e=>`
  <div class="${e.styles.header}" data-vc="header" role="toolbar" aria-label="${e.labels.navigation}">
    <#ArrowPrev [year] />
    <div class="${e.styles.headerContent}" data-vc-header="content">
      <#Month />
      <#Year />
    </div>
    <#ArrowNext [year] />
  </div>
  <div class="${e.styles.wrapper}" data-vc="wrapper">
    <div class="${e.styles.content}" data-vc="content">
      <#Years />
    </div>
  </div>
`,Vn=(e,t)=>`<button type="button" class="${e.styles.arrowNext}" data-vc-arrow="next" aria-label="${e.labels.arrowNext[t]}"></button>`,Un=(e,t)=>`<button type="button" class="${e.styles.arrowPrev}" data-vc-arrow="prev" aria-label="${e.labels.arrowPrev[t]}"></button>`,Zn=e=>e.selectionTimeMode?`<div class="${e.styles.time}" data-vc="time" role="group" aria-label="${e.labels.selectingTime}"></div>`:"",Gn=e=>e.onCreateDateRangeTooltip?`<div class="${e.styles.dateRangeTooltip}" data-vc-date-range-tooltip="hidden"></div>`:"",jn=e=>`<div class="${e.styles.dates}" data-vc="dates" role="grid" aria-live="assertive" aria-label="${e.labels.dates}" ${e.type==="multiple"?"aria-multiselectable":""}></div>`,Kn=e=>`<button type="button" class="${e.styles.month}" data-vc="month"></button>`,Jn=e=>`<div class="${e.styles.months}" data-vc="months" role="grid" aria-live="assertive" aria-label="${e.labels.months}"></div>`,Xn=e=>`<div class="${e.styles.week}" data-vc="week" role="row" aria-label="${e.labels.week}"></div>`,Qn=e=>e.enableWeekNumbers?`<div class="${e.styles.weekNumbers}" data-vc-week="numbers" role="row" aria-label="${e.labels.weekNumber}"></div>`:"",ea=e=>`<button type="button" class="${e.styles.year}" data-vc="year"></button>`,ta=e=>`<div class="${e.styles.years}" data-vc="years" role="grid" aria-live="assertive" aria-label="${e.labels.years}"></div>`,na={ArrowNext:Vn,ArrowPrev:Un,ControlTime:Zn,Dates:jn,DateRangeTooltip:Gn,Month:Kn,Months:Jn,Week:Xn,WeekNumbers:Qn,Year:ea,Years:ta},aa=e=>na[e],De=(e,t)=>t.replace(/[\n\t]/g,"").replace(/<#(?!\/?Multiple)(.*?)>/g,(n,a)=>{const o=(a.match(/\[(.*?)\]/)||[])[1],i=a.replace(/[/\s\n\t]|\[(.*?)\]/g,""),r=aa(i),s=r?r(e,o??null):"";return e.sanitizerHTML(s)}).replace(/[\n\t]/g,""),oa=(e,t)=>t.replace(new RegExp("<#Multiple>(.*?)<#\\/Multiple>","gs"),(n,a)=>{const o=Array(e.context.displayMonthsCount).fill(a).join("");return e.sanitizerHTML(o)}).replace(/[\n\t]/g,""),Me=(e,t)=>{const n={default:Yn,month:_n,year:Wn,multiple:zn};if(Object.keys(n).forEach(a=>{const o=a;e.layouts[o].length||(e.layouts[o]=n[o](e))}),e.context.mainElement.className=e.styles.calendar,e.context.mainElement.dataset.vc="calendar",e.context.mainElement.dataset.vcType=e.context.currentType,e.context.mainElement.role="application",e.context.mainElement.tabIndex=0,e.context.mainElement.ariaLabel=e.labels.application,e.context.currentType!=="multiple"){if(e.type==="multiple"&&t){const a=e.context.mainElement.querySelector('[data-vc="controls"]'),o=e.context.mainElement.querySelector('[data-vc="grid"]'),i=t.closest('[data-vc="column"]');return a&&e.context.mainElement.removeChild(a),o&&(o.dataset.vcGrid="hidden"),i&&(i.dataset.vcColumn=e.context.currentType),void(i&&(i.innerHTML=e.sanitizerHTML(De(e,e.layouts[e.context.currentType]))))}e.context.mainElement.innerHTML=e.sanitizerHTML(De(e,e.layouts[e.context.currentType]))}else e.context.mainElement.innerHTML=e.sanitizerHTML(oa(e,De(e,e.layouts[e.context.currentType])))},it=(e,t,n,a)=>{e.style.visibility=n?"hidden":"",t.style.visibility=a?"hidden":""},ia=(e,t,n)=>{const a=M(O(new Date(e.context.selectedYear,e.context.selectedMonth,1))),o=new Date(a.getTime()),i=new Date(a.getTime());o.setMonth(o.getMonth()-e.monthsToSwitch),i.setMonth(i.getMonth()+e.monthsToSwitch);const r=M(e.context.dateMin),s=M(e.context.dateMax);e.selectionYearsMode||(r.setFullYear(a.getFullYear()),s.setFullYear(a.getFullYear()));const l=!e.selectionMonthsMode||o.getFullYear()<r.getFullYear()||o.getFullYear()===r.getFullYear()&&o.getMonth()<r.getMonth(),d=!e.selectionMonthsMode||i.getFullYear()>s.getFullYear()||i.getFullYear()===s.getFullYear()&&i.getMonth()>s.getMonth()-(e.context.displayMonthsCount-1);it(t,n,l,d)},sa=(e,t,n)=>{const a=M(e.context.dateMin),o=M(e.context.dateMax),i=!!(a.getFullYear()&&e.context.displayYear-7<=a.getFullYear()),r=!!(o.getFullYear()&&e.context.displayYear+7>=o.getFullYear());it(t,n,i,r)},oe=e=>{if(e.context.currentType==="month")return;const t=e.context.mainElement.querySelector('[data-vc-arrow="prev"]'),n=e.context.mainElement.querySelector('[data-vc-arrow="next"]');!t||!n||{default:()=>ia(e,t,n),year:()=>sa(e,t,n)}[e.context.currentType==="multiple"?"default":e.context.currentType]()},ra=(e,t,n,a,o)=>{const i=new Date(a.setFullYear(e.context.selectedYear,e.context.selectedMonth+n)).getFullYear(),r=new Date(a.setMonth(e.context.selectedMonth+n)).getMonth(),s=e.context.locale.months.long[r],l=t.closest('[data-vc="column"]');l&&(l.ariaLabel=`${s} ${i}`);const d={month:{id:r,label:s},year:{id:i,label:i}};t.innerText=String(d[o].label),t.dataset[`vc${o.charAt(0).toUpperCase()+o.slice(1)}`]=String(d[o].id),t.ariaLabel=`${e.labels[o]} ${d[o].label}`;const u={month:e.selectionMonthsMode,year:e.selectionYearsMode},h=u[o]===!1||u[o]==="only-arrows";h&&(t.tabIndex=-1),t.disabled=h},j=e=>{const t=e.context.mainElement.querySelectorAll('[data-vc="month"]'),n=e.context.mainElement.querySelectorAll('[data-vc="year"]'),a=new Date(e.context.selectedYear,e.context.selectedMonth,1);[t,n].forEach(o=>o==null?void 0:o.forEach((i,r)=>ra(e,i,r,a,i.dataset.vc)))},Ce=(e,t,n,a,o)=>{var i;const r={month:"[data-vc-months-month]",year:"[data-vc-years-year]"},s={month:{selected:"data-vc-months-month-selected",aria:"aria-selected",value:"vcMonthsMonth",selectedProperty:"selectedMonth"},year:{selected:"data-vc-years-year-selected",aria:"aria-selected",value:"vcYearsYear",selectedProperty:"selectedYear"}};o&&((i=e.context.mainElement.querySelectorAll(r[n]))==null||i.forEach(l=>{l.removeAttribute(s[n].selected),l.removeAttribute(s[n].aria)}),x(e,s[n].selectedProperty,Number(t.dataset[s[n].value])),j(e),n==="year"&&oe(e)),a&&(t.setAttribute(s[n].selected,""),t.setAttribute(s[n].aria,"true"))},Se=(e,t)=>{var n;if(e.type!=="multiple")return{currentValue:null,columnID:0};const a=e.context.mainElement.querySelectorAll('[data-vc="column"]'),o=Array.from(a).findIndex(i=>i.closest(`[data-vc-column="${t}"]`));return{currentValue:o>=0?Number((n=a[o].querySelector(`[data-vc="${t}"]`))==null?void 0:n.getAttribute(`data-vc-${t}`)):null,columnID:Math.max(o,0)}},la=(e,t,n,a,o,i,r)=>{const s=t.cloneNode(!1);return s.className=e.styles.monthsMonth,s.innerText=a,s.ariaLabel=o,s.role="gridcell",s.dataset.vcMonthsMonth=`${r}`,i&&(s.ariaDisabled="true"),i&&(s.tabIndex=-1),s.disabled=i,Ce(e,s,"month",n===r,!1),s},st=(e,t)=>{var n,a;const o=(n=t==null?void 0:t.closest('[data-vc="header"]'))==null?void 0:n.querySelector('[data-vc="year"]'),i=o?Number(o.dataset.vcYear):e.context.selectedYear,r=t!=null&&t.dataset.vcMonth?Number(t.dataset.vcMonth):e.context.selectedMonth;x(e,"currentType","month"),Me(e,t),j(e);const s=e.context.mainElement.querySelector('[data-vc="months"]');if(!e.selectionMonthsMode||!s)return;const l=e.monthsToSwitch>1?e.context.locale.months.long.map((u,h)=>r-e.monthsToSwitch*h).concat(e.context.locale.months.long.map((u,h)=>r+e.monthsToSwitch*h)).filter(u=>u>=0&&u<=12):Array.from(Array(12).keys()),d=document.createElement("button");d.type="button";for(let u=0;u<12;u++){const h=M(e.context.dateMin),c=M(e.context.dateMax),m=e.context.displayMonthsCount-1,{columnID:f}=Se(e,"month"),y=i<=h.getFullYear()&&u<h.getMonth()+f||i>=c.getFullYear()&&u>c.getMonth()-m+f||i>c.getFullYear()||u!==r&&!l.includes(u),E=la(e,d,r,e.context.locale.months.short[u],e.context.locale.months.long[u],y,u);s.appendChild(E),e.onCreateMonthEls&&e.onCreateMonthEls(e,E)}(a=e.context.mainElement.querySelector("[data-vc-months-month]:not([disabled])"))==null||a.focus()},rt=(e,t,n,a,o)=>`
  <label class="${t}" data-vc-time-input="${e}">
    <input type="text" name="${e}" maxlength="2" aria-label="${n[`input${e.charAt(0).toUpperCase()+e.slice(1)}`]}" value="${a}" ${o?"disabled":""}>
  </label>
`,lt=(e,t,n,a,o,i,r)=>`
  <label class="${t}" data-vc-time-range="${e}">
    <input type="range" name="${e}" min="${a}" max="${o}" step="${i}" aria-label="${n[`range${e.charAt(0).toUpperCase()+e.slice(1)}`]}" value="${r}">
  </label>
`,K=(e,t,n,a)=>{({hour:()=>x(e,"selectedHours",n),minute:()=>x(e,"selectedMinutes",n)})[a](),x(e,"selectedTime",`${e.context.selectedHours}:${e.context.selectedMinutes}${e.context.selectedKeeping?` ${e.context.selectedKeeping}`:""}`),e.onChangeTime&&e.onChangeTime(e,t,!1),e.inputMode&&e.context.inputElement&&e.context.mainElement&&e.onChangeToInput&&e.onChangeToInput(e,t)},ie=(e,t)=>{var n;return((n={0:{AM:"00",PM:"12"},1:{AM:"01",PM:"13"},2:{AM:"02",PM:"14"},3:{AM:"03",PM:"15"},4:{AM:"04",PM:"16"},5:{AM:"05",PM:"17"},6:{AM:"06",PM:"18"},7:{AM:"07",PM:"19"},8:{AM:"08",PM:"20"},9:{AM:"09",PM:"21"},10:{AM:"10",PM:"22"},11:{AM:"11",PM:"23"},12:{AM:"00",PM:"12"}}[Number(e)])==null?void 0:n[t])||String(e)},ca=(e,t,n,a,o)=>{const i=r=>{const s=e.context.selectedKeeping==="AM"?"PM":"AM",l=ie(e.context.selectedHours,s);Number(l)<=a&&Number(l)>=o?(x(e,"selectedKeeping",s),n.value=l,K(e,r,e.context.selectedHours,"hour"),t.ariaLabel=`${e.labels.btnKeeping} ${e.context.selectedKeeping}`,t.innerText=e.context.selectedKeeping):e.onChangeTime&&e.onChangeTime(e,r,!0)};return t.addEventListener("click",i),()=>{t.removeEventListener("click",i)}},J=e=>({0:"12",13:"01",14:"02",15:"03",16:"04",17:"05",18:"06",19:"07",20:"08",21:"09",22:"10",23:"11"})[Number(e)]||String(e),se=(e,t,n,a)=>{e.value=n,t.value=a},da=(e,t,n)=>{t&&n&&(x(e,"selectedKeeping",n),t.innerText=n)},ct=(e,t,n,a,o,i,r)=>{const s={hour:(d,u,h)=>{e.selectionTimeMode&&{12:()=>{if(!e.context.selectedKeeping)return;const c=Number(ie(u,e.context.selectedKeeping));if(!(c<=i&&c>=r))return se(n,t,e.context.selectedHours,e.context.selectedHours),void(e.onChangeTime&&e.onChangeTime(e,h,!0));se(n,t,J(u),ie(u,e.context.selectedKeeping)),d>12&&da(e,a,"PM"),K(e,h,J(u),o)},24:()=>{if(!(d<=i&&d>=r))return se(n,t,e.context.selectedHours,e.context.selectedHours),void(e.onChangeTime&&e.onChangeTime(e,h,!0));se(n,t,u,u),K(e,h,u,o)}}[e.selectionTimeMode]()},minute:(d,u,h)=>{if(!(d<=i&&d>=r))return n.value=e.context.selectedMinutes,void(e.onChangeTime&&e.onChangeTime(e,h,!0));n.value=u,t.value=u,K(e,h,u,o)}},l=d=>{const u=Number(n.value),h=n.value.padStart(2,"0");s[o]&&s[o](u,h,d)};return n.addEventListener("change",l),()=>{n.removeEventListener("change",l)}},ua=(e,t,n,a,o)=>{t.value=o,K(e,n,o,a)},ha=(e,t,n)=>{t&&(x(e,"selectedKeeping",n),t.innerText=n)},dt=(e,t,n,a,o)=>{const i=r=>{const s=Number(t.value),l=t.value.padStart(2,"0"),d=o==="hour",u=e.selectionTimeMode===24,h=s>0&&s<12;d&&!u&&ha(e,a,s===0||h?"AM":"PM"),ua(e,n,r,o,!d||u||h?l:J(t.value))};return t.addEventListener("input",i),()=>{t.removeEventListener("input",i)}},ut=e=>e.setAttribute("data-vc-input-focus",""),ht=e=>e.removeAttribute("data-vc-input-focus"),ma=(e,t)=>{const n=t.querySelector('[data-vc-time-range="hour"] input[name="hour"]'),a=t.querySelector('[data-vc-time-range="minute"] input[name="minute"]'),o=t.querySelector('[data-vc-time-input="hour"] input[name="hour"]'),i=t.querySelector('[data-vc-time-input="minute"] input[name="minute"]'),r=t.querySelector('[data-vc-time="keeping"]');if(!(n&&a&&o&&i))return;const s=d=>{d.target===n&&ut(o),d.target===a&&ut(i)},l=d=>{d.target===n&&ht(o),d.target===a&&ht(i)};return t.addEventListener("mouseover",s),t.addEventListener("mouseout",l),ct(e,n,o,r,"hour",e.timeMaxHour,e.timeMinHour),ct(e,a,i,r,"minute",e.timeMaxMinute,e.timeMinMinute),dt(e,n,o,r,"hour"),dt(e,a,i,r,"minute"),r&&ca(e,r,n,e.timeMaxHour,e.timeMinHour),()=>{t.removeEventListener("mouseover",s),t.removeEventListener("mouseout",l)}},ga=e=>{const t=e.context.mainElement.querySelector('[data-vc="time"]');if(!e.selectionTimeMode||!t)return;const[n,a]=[e.timeMinHour,e.timeMaxHour],[o,i]=[e.timeMinMinute,e.timeMaxMinute],r=e.context.selectedKeeping?ie(e.context.selectedHours,e.context.selectedKeeping):e.context.selectedHours,s=e.timeControls==="range";var l;t.innerHTML=e.sanitizerHTML(`
    <div class="${e.styles.timeContent}" data-vc-time="content">
      ${rt("hour",e.styles.timeHour,e.labels,e.context.selectedHours,s)}
      ${rt("minute",e.styles.timeMinute,e.labels,e.context.selectedMinutes,s)}
      ${e.selectionTimeMode===12?(l=e.context.selectedKeeping,`<button type="button" class="${e.styles.timeKeeping}" aria-label="${e.labels.btnKeeping} ${l}" data-vc-time="keeping" ${s?"disabled":""}>${l}</button>`):""}
    </div>
    <div class="${e.styles.timeRanges}" data-vc-time="ranges">
      ${lt("hour",e.styles.timeRange,e.labels,n,a,e.timeStepHour,r)}
      ${lt("minute",e.styles.timeRange,e.labels,o,i,e.timeStepMinute,e.context.selectedMinutes)}
    </div>
  `),ma(e,t)},mt=e=>{const t=e.selectedWeekends?[...e.selectedWeekends]:[],n=[...e.context.locale.weekdays.long].reduce((o,i,r)=>[...o,{id:r,titleShort:e.context.locale.weekdays.short[r],titleLong:i,isWeekend:t.includes(r)}],[]),a=[...n.slice(e.firstWeekday),...n.slice(0,e.firstWeekday)];e.context.mainElement.querySelectorAll('[data-vc="week"]').forEach(o=>{const i=e.onClickWeekDay?document.createElement("button"):document.createElement("b");e.onClickWeekDay&&(i.type="button"),a.forEach(r=>{const s=i.cloneNode(!0);s.innerText=r.titleShort,s.className=e.styles.weekDay,s.role="columnheader",s.ariaLabel=r.titleLong,s.dataset.vcWeekDay=String(r.id),r.isWeekend&&(s.dataset.vcWeekDayOff=""),o.appendChild(s)})})},fa=(e,t,n,a,o)=>{const i=t.cloneNode(!1);return i.className=e.styles.yearsYear,i.innerText=String(o),i.ariaLabel=String(o),i.role="gridcell",i.dataset.vcYearsYear=`${o}`,a&&(i.ariaDisabled="true"),a&&(i.tabIndex=-1),i.disabled=a,Ce(e,i,"year",n===o,!1),i},ke=(e,t)=>{var n;const a=t!=null&&t.dataset.vcYear?Number(t.dataset.vcYear):e.context.selectedYear;x(e,"currentType","year"),Me(e,t),j(e),oe(e);const o=e.context.mainElement.querySelector('[data-vc="years"]');if(!e.selectionYearsMode||!o)return;const i=e.type!=="multiple"||e.context.selectedYear===a?0:1,r=document.createElement("button");r.type="button";for(let s=e.context.displayYear-7;s<e.context.displayYear+8;s++){const l=s<M(e.context.dateMin).getFullYear()+i||s>M(e.context.dateMax).getFullYear(),d=fa(e,r,a,l,s);o.appendChild(d),e.onCreateYearEls&&e.onCreateYearEls(e,d)}(n=e.context.mainElement.querySelector("[data-vc-years-year]:not([disabled])"))==null||n.focus()},pa=(e,t,n)=>{new MutationObserver(a=>{for(let o=0;o<a.length;o++)if(a[o].attributeName===t){n();break}}).observe(e,{attributes:!0})},re={value:!1,set:()=>re.value=!0,check:()=>re.value},U=(e,t)=>e.dataset.vcTheme=t,gt=(e,t)=>{if(U(e.context.mainElement,t.matches?"dark":"light"),e.selectedTheme!=="system"||re.check())return;const n=a=>{const o=document.querySelectorAll('[data-vc="calendar"]');o==null||o.forEach(i=>U(i,a.matches?"dark":"light"))};t.addEventListener?t.addEventListener("change",n):t.addListener(n),re.set()},va=(e,t)=>{const n=e.themeAttrDetect.length?document.querySelector(e.themeAttrDetect):null,a=e.themeAttrDetect.replace(/^.*\[(.+)\]/g,(i,r)=>r);if(!n||n.getAttribute(a)==="system")return void gt(e,t);const o=n.getAttribute(a);o?(U(e.context.mainElement,o),pa(n,a,()=>{const i=n.getAttribute(a);i&&U(e.context.mainElement,i)})):gt(e,t)},ya=e=>{window.matchMedia("(prefers-color-scheme)").media!=="not all"?e.selectedTheme==="system"?va(e,window.matchMedia("(prefers-color-scheme: dark)")):U(e.context.mainElement,e.selectedTheme):U(e.context.mainElement,"light")},le=e=>e.charAt(0).toUpperCase()+e.slice(1).replace(/\./,""),ba=(e,t,n)=>{const a=new Date(`1978-01-0${t+1}T00:00:00.000Z`),o=a.toLocaleString(n,{weekday:"short",timeZone:"UTC"}),i=a.toLocaleString(n,{weekday:"long",timeZone:"UTC"});e.context.locale.weekdays.short.push(le(o)),e.context.locale.weekdays.long.push(le(i))},wa=(e,t,n)=>{const a=new Date(`1978-${String(t+1).padStart(2,"0")}-01T00:00:00.000Z`),o=a.toLocaleString(n,{month:"short",timeZone:"UTC"}),i=a.toLocaleString(n,{month:"long",timeZone:"UTC"});e.context.locale.months.short.push(le(o)),e.context.locale.months.long.push(le(i))},xa=e=>{var t,n,a,o,i,r,s,l;if(!(e.context.locale.weekdays.short[6]&&e.context.locale.weekdays.long[6]&&e.context.locale.months.short[11]&&e.context.locale.months.long[11]))if(typeof e.locale=="string"){if(typeof e.locale=="string"&&!e.locale.length)throw new Error(B.notLocale);Array.from({length:7},(d,u)=>ba(e,u,e.locale)),Array.from({length:12},(d,u)=>wa(e,u,e.locale))}else{if(!((n=(t=e.locale)==null?void 0:t.weekdays)!=null&&n.short[6]&&((o=(a=e.locale)==null?void 0:a.weekdays)!=null&&o.long[6])&&((r=(i=e.locale)==null?void 0:i.months)!=null&&r.short[11])&&((l=(s=e.locale)==null?void 0:s.months)!=null&&l.long[11])))throw new Error(B.notLocale);x(e,"locale",V({},e.locale))}},ce=e=>{const t={default:()=>{mt(e),Ee(e)},multiple:()=>{mt(e),Ee(e)},month:()=>st(e),year:()=>ke(e)};ya(e),xa(e),Me(e),j(e),oe(e),ga(e),t[e.context.currentType]()},ft=e=>{const t=n=>{var a;const o=n.target;if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.key)||o.localName!=="button")return;const i=Array.from(e.context.mainElement.querySelectorAll('[data-vc="calendar"] button')),r=i.indexOf(o);if(r===-1)return;const s=(l=i[r]).hasAttribute("data-vc-date-btn")?7:l.hasAttribute("data-vc-months-month")?4:l.hasAttribute("data-vc-years-year")?5:1;var l;const d=(0,{ArrowUp:()=>Math.max(0,r-s),ArrowDown:()=>Math.min(i.length-1,r+s),ArrowLeft:()=>Math.max(0,r-1),ArrowRight:()=>Math.min(i.length-1,r+1)}[n.key])();(a=i[d])==null||a.focus()};return e.context.mainElement.addEventListener("keydown",t),()=>e.context.mainElement.removeEventListener("keydown",t)},Ie=(e,t)=>{const n=M(O(new Date(e.context.selectedYear,e.context.selectedMonth,1)));({prev:()=>n.setMonth(n.getMonth()-e.monthsToSwitch),next:()=>n.setMonth(n.getMonth()+e.monthsToSwitch)})[t](),x(e,"selectedMonth",n.getMonth()),x(e,"selectedYear",n.getFullYear()),j(e),oe(e),Ee(e)},Ea=(e,t)=>{const n=t.target.closest("[data-vc-arrow]");if(n){if(["default","multiple"].includes(e.context.currentType))Ie(e,n.dataset.vcArrow);else if(e.context.currentType==="year"&&e.context.displayYear!==void 0){const a={prev:-15,next:15}[n.dataset.vcArrow];x(e,"displayYear",e.context.displayYear+a),ke(e,t.target)}e.onClickArrow&&e.onClickArrow(e,t)}},Le=e=>e.enableDateToggle===void 0||(typeof e.enableDateToggle=="function"?e.enableDateToggle(e):e.enableDateToggle),pt=(e,t,n)=>{const a=t.dataset.vcDate,o=t.closest("[data-vc-date][data-vc-date-selected]"),i=Le(e);if(o&&!i)return;const r=o?e.context.selectedDates.filter(s=>s!==a):n?[...e.context.selectedDates,a]:[a];x(e,"selectedDates",r)},A=(e,t,n)=>{if(!t)return;if(!n)return t.dataset.vcDateRangeTooltip="hidden",void(t.textContent="");const a=e.context.mainElement.getBoundingClientRect(),o=n.getBoundingClientRect();t.style.left=o.left-a.left+o.width/2+"px",t.style.top=o.bottom-a.top-o.height+"px",t.dataset.vcDateRangeTooltip="visible",t.innerHTML=e.sanitizerHTML(e.onCreateDateRangeTooltip(e,n,t,o,a))},v={self:null,lastDateEl:null,isHovering:!1,rangeMin:void 0,rangeMax:void 0,tooltipEl:null,timeoutId:null},Da=(e,t,n)=>{var a,o,i;if(!((o=(a=v.self)==null?void 0:a.context)!=null&&o.selectedDates[0]))return;const r=O(e);(i=v.self.context.disableDates)!=null&&i.includes(r)||(v.self.context.mainElement.querySelectorAll(`[data-vc-date="${r}"]`).forEach(s=>s.dataset.vcDateHover=""),t.forEach(s=>s.dataset.vcDateHover="first"),n.forEach(s=>{s.dataset.vcDateHover==="first"?s.dataset.vcDateHover="first-and-last":s.dataset.vcDateHover="last"}))},X=()=>{var e,t;(t=(e=v.self)==null?void 0:e.context)!=null&&t.mainElement&&v.self.context.mainElement.querySelectorAll("[data-vc-date-hover]").forEach(n=>n.removeAttribute("data-vc-date-hover"))},Ma=e=>{var t,n;if(!e.target||!((n=(t=v.self)==null?void 0:t.context)!=null&&n.selectedDates[0]))return;if(!e.target.closest('[data-vc="dates"]'))return v.lastDateEl=null,A(v.self,v.tooltipEl,null),void X();const a=e.target.closest("[data-vc-date]");if(!a||v.lastDateEl===a)return;v.lastDateEl=a,A(v.self,v.tooltipEl,a),X();const o=a.dataset.vcDate,i=M(v.self.context.selectedDates[0]),r=M(o),s=v.self.context.mainElement.querySelectorAll(`[data-vc-date="${v.self.context.selectedDates[0]}"]`),l=v.self.context.mainElement.querySelectorAll(`[data-vc-date="${o}"]`),[d,u]=i<r?[s,l]:[l,s],[h,c]=i<r?[i,r]:[r,i];for(let m=new Date(h);m<=c;m.setDate(m.getDate()+1))Da(m,d,u)},Ca=e=>{const t=e.target.closest("[data-vc-date-selected]");if(!t&&v.lastDateEl)return v.lastDateEl=null,void A(v.self,v.tooltipEl,null);t&&v.lastDateEl!==t&&(v.lastDateEl=t,A(v.self,v.tooltipEl,t))},vt=e=>t=>{v.isHovering||(v.isHovering=!0,requestAnimationFrame(()=>{e(t),v.isHovering=!1}))},de=vt(Ma),ue=vt(Ca),Q=e=>{v.self&&e.key==="Escape"&&(v.lastDateEl=null,x(v.self,"selectedDates",[]),v.self.context.mainElement.removeEventListener("mousemove",de),v.self.context.mainElement.removeEventListener("keydown",Q),A(v.self,v.tooltipEl,null),X())},H=()=>{v.timeoutId!==null&&clearTimeout(v.timeoutId),v.timeoutId=setTimeout(()=>{v.lastDateEl=null,A(v.self,v.tooltipEl,null),X()},50)},Sa=()=>{var e,t,n,a;if(!((n=(t=(e=v.self)==null?void 0:e.context)==null?void 0:t.selectedDates)!=null&&n[0])||!((a=v.self.context.disableDates)!=null&&a[0]))return;const o=M(v.self.context.selectedDates[0]),[i,r]=v.self.context.disableDates.map(s=>M(s)).reduce(([s,l],d)=>[o>=d?d:s,o<d&&l===null?d:l],[null,null]);i&&x(v.self,"displayDateMin",O(new Date(i.setDate(i.getDate()+1)))),r&&x(v.self,"displayDateMax",O(new Date(r.setDate(r.getDate()-1)))),v.self.disableDatesPast&&!v.self.disableAllDates&&M(v.self.context.displayDateMin)<M(v.self.context.dateToday)&&x(v.self,"displayDateMin",v.self.context.dateToday)},yt=(e,t)=>{v.self=e,v.lastDateEl=t,X(),e.disableDatesGaps&&(v.rangeMin=v.rangeMin?v.rangeMin:e.context.displayDateMin,v.rangeMax=v.rangeMax?v.rangeMax:e.context.displayDateMax),e.onCreateDateRangeTooltip&&(v.tooltipEl=e.context.mainElement.querySelector("[data-vc-date-range-tooltip]"));const n=t==null?void 0:t.dataset.vcDate;if(n){const a=e.context.selectedDates.length===1&&e.context.selectedDates[0].includes(n),o=a&&!Le(e)?[n,n]:a&&Le(e)?[]:e.context.selectedDates.length>1?[n]:[...e.context.selectedDates,n];x(e,"selectedDates",o),e.context.selectedDates.length>1&&e.context.selectedDates.sort((i,r)=>+new Date(i)-+new Date(r))}({set:()=>(e.disableDatesGaps&&Sa(),A(v.self,v.tooltipEl,t),v.self.context.mainElement.removeEventListener("mousemove",ue),v.self.context.mainElement.removeEventListener("mouseleave",H),v.self.context.mainElement.removeEventListener("keydown",Q),v.self.context.mainElement.addEventListener("mousemove",de),v.self.context.mainElement.addEventListener("mouseleave",H),v.self.context.mainElement.addEventListener("keydown",Q),()=>{v.self.context.mainElement.removeEventListener("mousemove",de),v.self.context.mainElement.removeEventListener("mouseleave",H),v.self.context.mainElement.removeEventListener("keydown",Q)}),reset:()=>{const[a,o]=[e.context.selectedDates[0],e.context.selectedDates[e.context.selectedDates.length-1]],i=e.context.selectedDates[0]!==e.context.selectedDates[e.context.selectedDates.length-1],r=R([`${a}:${o}`]).filter(l=>!e.context.disableDates.includes(l)),s=i?e.enableEdgeDatesOnly?[a,o]:r:[e.context.selectedDates[0],e.context.selectedDates[0]];if(x(e,"selectedDates",s),e.disableDatesGaps&&(x(e,"displayDateMin",v.rangeMin),x(e,"displayDateMax",v.rangeMax)),v.self.context.mainElement.removeEventListener("mousemove",de),v.self.context.mainElement.removeEventListener("mouseleave",H),v.self.context.mainElement.removeEventListener("keydown",Q),e.onCreateDateRangeTooltip)return e.context.selectedDates[0]||(v.self.context.mainElement.removeEventListener("mousemove",ue),v.self.context.mainElement.removeEventListener("mouseleave",H),A(v.self,v.tooltipEl,null)),e.context.selectedDates[0]&&(v.self.context.mainElement.addEventListener("mousemove",ue),v.self.context.mainElement.addEventListener("mouseleave",H),A(v.self,v.tooltipEl,t)),()=>{v.self.context.mainElement.removeEventListener("mousemove",ue),v.self.context.mainElement.removeEventListener("mouseleave",H)}}})[e.context.selectedDates.length===1?"set":"reset"]()},Pe=e=>{e.context.mainElement.querySelectorAll("[data-vc-date]").forEach(t=>{const n=t.querySelector("[data-vc-date-btn]"),a=t.dataset.vcDate,o=M(a).getDay();at(e,e.context.selectedYear,t,n,o,a,"current")})},ka=(e,t)=>{var n;const a=t.target,o=a.closest("[data-vc-date-btn]");if(!e.selectionDatesMode||!["single","multiple","multiple-ranged"].includes(e.selectionDatesMode)||!o)return;const i=o.closest("[data-vc-date]");({single:()=>pt(e,i,!1),multiple:()=>pt(e,i,!0),"multiple-ranged":()=>yt(e,i)})[e.selectionDatesMode](),(n=e.context.selectedDates)==null||n.sort((l,d)=>+new Date(l)-+new Date(d)),e.onClickDate&&e.onClickDate(e,t),e.inputMode&&e.context.inputElement&&e.context.mainElement&&e.onChangeToInput&&e.onChangeToInput(e,t);const r=a.closest('[data-vc-date-month="prev"]'),s=a.closest('[data-vc-date-month="next"]');({prev:()=>e.enableMonthChangeOnDayClick?Ie(e,"prev"):Pe(e),next:()=>e.enableMonthChangeOnDayClick?Ie(e,"next"):Pe(e),current:()=>Pe(e)})[r?"prev":s?"next":"current"]()},Ia=["month","year"],bt=(e,t,n)=>{const{currentValue:a,columnID:o}=Se(e,t);return e.context.currentType==="month"&&o>=0?n-o:e.context.currentType==="year"&&e.context.selectedYear!==a?n-1:n},La=(e,t)=>{const n=bt(e,"year",Number(t.dataset.vcYearsYear)),a=M(e.context.dateMin),o=M(e.context.dateMax),i=e.context.displayMonthsCount-1,{columnID:r}=Se(e,"year"),s=e.context.selectedMonth<a.getMonth()&&n<=a.getFullYear(),l=e.context.selectedMonth>o.getMonth()-i+r&&n>=o.getFullYear(),d=n<a.getFullYear(),u=n>o.getFullYear(),h=s||d?a.getFullYear():l||u?o.getFullYear():n,c=s||d?a.getMonth():l||u?o.getMonth()-i+r:e.context.selectedMonth;x(e,"selectedYear",h),x(e,"selectedMonth",c)},Pa=(e,t)=>{const n=t.closest('[data-vc-column="month"]').querySelector('[data-vc="year"]'),a=bt(e,"month",Number(t.dataset.vcMonthsMonth)),o=Number(n.dataset.vcYear),i=M(e.context.dateMin),r=M(e.context.dateMax),s=a<i.getMonth()&&o<=i.getFullYear(),l=a>r.getMonth()&&o>=r.getFullYear();x(e,"selectedYear",o),x(e,"selectedMonth",s?i.getMonth():l?r.getMonth():a)},Aa=(e,t,n,a)=>{var o;({year:()=>{if(e.type==="multiple")return La(e,a);x(e,"selectedYear",Number(a.dataset.vcYearsYear))},month:()=>{if(e.type==="multiple")return Pa(e,a);x(e,"selectedMonth",Number(a.dataset.vcMonthsMonth))}})[n](),{year:()=>{var i;return(i=e.onClickYear)==null?void 0:i.call(e,e,t)},month:()=>{var i;return(i=e.onClickMonth)==null?void 0:i.call(e,e,t)}}[n](),e.context.currentType!==e.type?(x(e,"currentType",e.type),ce(e),(o=e.context.mainElement.querySelector(`[data-vc="${n}"]`))==null||o.focus()):Ce(e,a,n,!0,!0)},Ta=(e,t,n)=>{var a;const o=t.target,i=o.closest(`[data-vc="${n}"]`),r={year:()=>ke(e,o),month:()=>st(e,o)};if(i&&e.onClickTitle&&e.onClickTitle(e,t),i&&e.context.currentType!==n)return r[n]();const s=o.closest(`[data-vc-${n}s-${n}]`);if(s)return Aa(e,t,n,s);const l=o.closest('[data-vc="grid"]'),d=o.closest('[data-vc="column"]');(e.context.currentType===n&&i||e.type==="multiple"&&e.context.currentType===n&&l&&!d)&&(x(e,"currentType",e.type),ce(e),(a=e.context.mainElement.querySelector(`[data-vc="${n}"]`))==null||a.focus())},qa=(e,t)=>{const n={month:e.selectionMonthsMode,year:e.selectionYearsMode};Ia.forEach(a=>{n[a]&&t.target&&Ta(e,t,a)})},$a=(e,t)=>{if(!e.enableWeekNumbers||!e.onClickWeekNumber)return;const n=t.target.closest("[data-vc-week-number]"),a=e.context.mainElement.querySelectorAll("[data-vc-date-week-number]");if(!n||!a[0])return;const o=Number(n.innerText),i=Number(n.dataset.vcWeekYear),r=Array.from(a).filter(s=>Number(s.dataset.vcDateWeekNumber)===o);e.onClickWeekNumber(e,o,i,r,t)},Ba=(e,t)=>{if(!e.onClickWeekDay)return;const n=t.target.closest("[data-vc-week-day]"),a=t.target.closest('[data-vc="column"]'),o=a?a.querySelectorAll("[data-vc-date-week-day]"):e.context.mainElement.querySelectorAll("[data-vc-date-week-day]");if(!n||!o[0])return;const i=Number(n.dataset.vcWeekDay),r=Array.from(o).filter(s=>Number(s.dataset.vcDateWeekDay)===i);e.onClickWeekDay(e,i,r,t)},wt=e=>{const t=n=>{Ea(e,n),Ba(e,n),$a(e,n),ka(e,n),qa(e,n)};return e.context.mainElement.addEventListener("click",t),()=>e.context.mainElement.removeEventListener("click",t)},Na=e=>{if(e.type==="multiple"&&(e.displayMonthsCount<=1||e.displayMonthsCount>12))throw new Error(B.incorrectMonthsCount);if(e.type!=="multiple"&&e.displayMonthsCount>1)throw new Error(B.incorrectMonthsCount);x(e,"displayMonthsCount",e.displayMonthsCount?e.displayMonthsCount:e.type==="multiple"?2:1)},Fa=()=>{const e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().substring(0,10)},ee=(e,t)=>e==="today"?Fa():e instanceof Date||typeof e=="number"||typeof e=="string"?R([e])[0]:t,Oa=e=>{var t,n,a;const o=ee(e.dateMin,e.dateMin),i=ee(e.dateMax,e.dateMax),r=ee(e.displayDateMin,o),s=ee(e.displayDateMax,i);x(e,"dateToday",ee(e.dateToday,e.dateToday)),x(e,"displayDateMin",r?M(o)>=M(r)?o:r:o),x(e,"displayDateMax",s?M(i)<=M(s)?i:s:i);const l=e.disableDatesPast&&!e.disableAllDates&&M(r)<M(e.context.dateToday);x(e,"displayDateMin",l||e.disableAllDates?e.context.dateToday:r),x(e,"displayDateMax",e.disableAllDates?e.context.dateToday:s),x(e,"disableDates",e.disableDates[0]&&!e.disableAllDates?R(e.disableDates):e.disableAllDates?[e.context.displayDateMin]:[]),e.context.disableDates.length>1&&e.context.disableDates.sort((d,u)=>+new Date(d)-+new Date(u)),x(e,"enableDates",e.enableDates[0]?R(e.enableDates):[]),(t=e.context.enableDates)!=null&&t[0]&&((n=e.context.disableDates)!=null&&n[0])&&x(e,"disableDates",e.context.disableDates.filter(d=>!e.context.enableDates.includes(d))),e.context.enableDates.length>1&&e.context.enableDates.sort((d,u)=>+new Date(d)-+new Date(u)),(a=e.context.enableDates)!=null&&a[0]&&e.disableAllDates&&(x(e,"displayDateMin",e.context.enableDates[0]),x(e,"displayDateMax",e.context.enableDates[e.context.enableDates.length-1])),x(e,"dateMin",e.displayDisabledDates?o:e.context.displayDateMin),x(e,"dateMax",e.displayDisabledDates?i:e.context.displayDateMax)},Ra=e=>{var t;x(e,"selectedDates",(t=e.selectedDates)!=null&&t[0]?R(e.selectedDates):[])},xt=(e,t,n)=>{x(e,"selectedMonth",t),x(e,"selectedYear",n),x(e,"displayYear",n)},Ha=e=>{var t;if(e.enableJumpToSelectedDate&&((t=e.selectedDates)!=null&&t[0])&&e.selectedMonth===void 0&&e.selectedYear===void 0){const o=M(R(e.selectedDates)[0]);return void xt(e,o.getMonth(),o.getFullYear())}const n=e.selectedMonth!==void 0&&Number(e.selectedMonth)>=0&&Number(e.selectedMonth)<12,a=e.selectedYear!==void 0&&Number(e.selectedYear)>=0&&Number(e.selectedYear)<=9999;xt(e,n?Number(e.selectedMonth):M(e.context.dateToday).getMonth(),a?Number(e.selectedYear):M(e.context.dateToday).getFullYear())},Ya=e=>{var t,n,a;if(!e.selectionTimeMode)return;if(![12,24].includes(e.selectionTimeMode))throw new Error(B.incorrectTime);const o=e.selectionTimeMode===12,i=o?/^(0[1-9]|1[0-2]):([0-5][0-9]) ?(AM|PM)?$/i:/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])$/;let[r,s,l]=(a=(n=(t=e.selectedTime)==null?void 0:t.match(i))==null?void 0:n.slice(1))!=null?a:[];r?o&&!l&&(l="AM"):(r=o?J(String(e.timeMinHour)):String(e.timeMinHour),s=String(e.timeMinMinute),l=o?Number(J(String(e.timeMinHour)))>=12?"PM":"AM":null),x(e,"selectedHours",r.padStart(2,"0")),x(e,"selectedMinutes",s.padStart(2,"0")),x(e,"selectedKeeping",l),x(e,"selectedTime",`${e.context.selectedHours}:${e.context.selectedMinutes}${l?` ${l}`:""}`)},Et=e=>{x(e,"currentType",e.type),Na(e),Oa(e),Ha(e),Ra(e),Ya(e)},Dt=(e,{year:t,month:n,dates:a,time:o,locale:i},r=!0)=>{var s;const l={year:e.selectedYear,month:e.selectedMonth,dates:e.selectedDates,time:e.selectedTime};e.selectedYear=t?l.year:e.context.selectedYear,e.selectedMonth=n?l.month:e.context.selectedMonth,e.selectedTime=o?l.time:e.context.selectedTime,e.selectedDates=a==="only-first"&&((s=e.context.selectedDates)!=null&&s[0])?[e.context.selectedDates[0]]:a===!0?l.dates:e.context.selectedDates,i&&x(e,"locale",{months:{short:[],long:[]},weekdays:{short:[],long:[]}}),Et(e),r&&ce(e),e.selectedYear=l.year,e.selectedMonth=l.month,e.selectedDates=l.dates,e.selectedTime=l.time,e.selectionDatesMode==="multiple-ranged"&&a&&yt(e,null)},_a=e=>{const t=document.createElement("div");return t.className=e.styles.calendar,t.dataset.vc="calendar",t.dataset.vcInput="",t.dataset.vcCalendarHidden="",x(e,"inputModeInit",!0),x(e,"isShowInInputMode",!1),x(e,"mainElement",t),document.body.appendChild(e.context.mainElement),Dt(e,{year:!0,month:!0,dates:!0,time:!0,locale:!0}),queueMicrotask(()=>Te(e)),e.onInit&&e.onInit(e),ft(e),wt(e)},za=e=>{x(e,"inputElement",e.context.mainElement);const t=()=>{e.context.inputModeInit?queueMicrotask(()=>Te(e)):_a(e)};return e.context.inputElement.addEventListener("click",t),e.context.inputElement.addEventListener("focus",t),()=>{e.context.inputElement.removeEventListener("click",t),e.context.inputElement.removeEventListener("focus",t)}},Wa=e=>(x(e,"originalElement",e.context.mainElement.cloneNode(!0)),x(e,"isInit",!0),e.inputMode?za(e):(Et(e),ce(e),e.onInit&&e.onInit(e),ft(e),wt(e))),Mt=(e,t)=>{if(!e.context.isInit)throw new Error(B.notInit);Dt(e,V(V({},{year:!0,month:!0,dates:!0,time:!0,locale:!0}),t),!(e.inputMode&&!e.context.inputModeInit)),e.onUpdate&&e.onUpdate(e)},Ae=(e,t)=>{const n=Object.keys(t);for(let a=0;a<n.length;a++){const o=n[a];typeof e[o]!="object"||typeof t[o]!="object"||t[o]instanceof Date||Array.isArray(t[o])?t[o]!==void 0&&(e[o]=t[o]):Ae(e[o],t[o])}},Va=(e,t,n)=>{Ae(e,t),e.context.isInit&&Mt(e,n)};function Ua(e,t){const n="left";if(!t||!e)return n;const{canShow:a,parentPositions:o}=nt(e,t),i=a.left&&a.right;return(i&&a.bottom?"center":i&&a.top?["top","center"]:Array.isArray(o)?[o[0]==="bottom"?"top":"bottom",...o.slice(1)]:o)||n}const Ct=(e,t,n)=>{if(!e)return;const a=n==="auto"?Ua(e,t):n,o={top:-t.offsetHeight,bottom:e.offsetHeight,left:0,center:e.offsetWidth/2-t.offsetWidth/2,right:e.offsetWidth-t.offsetWidth},i=Array.isArray(a)?a[0]:"bottom",r=Array.isArray(a)?a[1]:a;t.dataset.vcPosition=i;const{top:s,left:l}=be(e),d=s+o[i];let u=l+o[r];const{vw:h}=we();if(u+t.clientWidth>h){const c=window.innerWidth-document.body.clientWidth;u=h-t.clientWidth-c}else u<0&&(u=0);Object.assign(t.style,{left:`${u}px`,top:`${d}px`})},Te=e=>{if(e.context.isShowInInputMode)return;if(!e.context.currentType)return void e.context.mainElement.click();x(e,"cleanupHandlers",[]),x(e,"isShowInInputMode",!0),Ct(e.context.inputElement,e.context.mainElement,e.positionToInput),e.context.mainElement.removeAttribute("data-vc-calendar-hidden");const t=()=>{Ct(e.context.inputElement,e.context.mainElement,e.positionToInput)};window.addEventListener("resize",t),e.context.cleanupHandlers.push(()=>window.removeEventListener("resize",t));const n=o=>{o.key==="Escape"&&ye(e)};document.addEventListener("keydown",n),e.context.cleanupHandlers.push(()=>document.removeEventListener("keydown",n));const a=o=>{o.target===e.context.inputElement||e.context.mainElement.contains(o.target)||ye(e)};document.addEventListener("click",a,{capture:!0}),e.context.cleanupHandlers.push(()=>document.removeEventListener("click",a,{capture:!0})),e.onShow&&e.onShow(e)},Za={application:"Calendar",navigation:"Calendar Navigation",arrowNext:{month:"Next month",year:"Next list of years"},arrowPrev:{month:"Previous month",year:"Previous list of years"},month:"Select month, current selected month:",months:"List of months",year:"Select year, current selected year:",years:"List of years",week:"Days of the week",weekNumber:"Numbers of weeks in a year",dates:"Dates in the current month",selectingTime:"Selecting a time ",inputHour:"Hours",inputMinute:"Minutes",rangeHour:"Slider for selecting hours",rangeMinute:"Slider for selecting minutes",btnKeeping:"Switch AM/PM, current position:"},Ga={calendar:"vc",controls:"vc-controls",grid:"vc-grid",column:"vc-column",header:"vc-header",headerContent:"vc-header__content",month:"vc-month",year:"vc-year",arrowPrev:"vc-arrow vc-arrow_prev",arrowNext:"vc-arrow vc-arrow_next",wrapper:"vc-wrapper",content:"vc-content",months:"vc-months",monthsMonth:"vc-months__month",years:"vc-years",yearsYear:"vc-years__year",week:"vc-week",weekDay:"vc-week__day",weekNumbers:"vc-week-numbers",weekNumbersTitle:"vc-week-numbers__title",weekNumbersContent:"vc-week-numbers__content",weekNumber:"vc-week-number",dates:"vc-dates",date:"vc-date",dateBtn:"vc-date__btn",datePopup:"vc-date__popup",dateRangeTooltip:"vc-date-range-tooltip",time:"vc-time",timeContent:"vc-time__content",timeHour:"vc-time__hour",timeMinute:"vc-time__minute",timeKeeping:"vc-time__keeping",timeRanges:"vc-time__ranges",timeRange:"vc-time__range"};class ja{constructor(){b(this,"type","default"),b(this,"inputMode",!1),b(this,"positionToInput","left"),b(this,"firstWeekday",1),b(this,"monthsToSwitch",1),b(this,"themeAttrDetect","html[data-theme]"),b(this,"locale","en"),b(this,"dateToday","today"),b(this,"dateMin","1970-01-01"),b(this,"dateMax","2470-12-31"),b(this,"displayDateMin"),b(this,"displayDateMax"),b(this,"displayDatesOutside",!0),b(this,"displayDisabledDates",!1),b(this,"displayMonthsCount"),b(this,"disableDates",[]),b(this,"disableAllDates",!1),b(this,"disableDatesPast",!1),b(this,"disableDatesGaps",!1),b(this,"disableWeekdays",[]),b(this,"disableToday",!1),b(this,"enableDates",[]),b(this,"enableEdgeDatesOnly",!0),b(this,"enableDateToggle",!0),b(this,"enableWeekNumbers",!1),b(this,"enableMonthChangeOnDayClick",!0),b(this,"enableJumpToSelectedDate",!1),b(this,"selectionDatesMode","single"),b(this,"selectionMonthsMode",!0),b(this,"selectionYearsMode",!0),b(this,"selectionTimeMode",!1),b(this,"selectedDates",[]),b(this,"selectedMonth"),b(this,"selectedYear"),b(this,"selectedHolidays",[]),b(this,"selectedWeekends",[0,6]),b(this,"selectedTime"),b(this,"selectedTheme","system"),b(this,"timeMinHour",0),b(this,"timeMaxHour",23),b(this,"timeMinMinute",0),b(this,"timeMaxMinute",59),b(this,"timeControls","all"),b(this,"timeStepHour",1),b(this,"timeStepMinute",1),b(this,"sanitizerHTML",t=>t),b(this,"onClickDate"),b(this,"onClickWeekDay"),b(this,"onClickWeekNumber"),b(this,"onClickTitle"),b(this,"onClickMonth"),b(this,"onClickYear"),b(this,"onClickArrow"),b(this,"onChangeTime"),b(this,"onChangeToInput"),b(this,"onCreateDateRangeTooltip"),b(this,"onCreateDateEls"),b(this,"onCreateMonthEls"),b(this,"onCreateYearEls"),b(this,"onInit"),b(this,"onUpdate"),b(this,"onDestroy"),b(this,"onShow"),b(this,"onHide"),b(this,"popups",{}),b(this,"labels",V({},Za)),b(this,"layouts",{default:"",multiple:"",month:"",year:""}),b(this,"styles",V({},Ga))}}const St=class Ke extends ja{constructor(t,n){var a;super(),b(this,"init",()=>Wa(this)),b(this,"update",o=>Mt(this,o)),b(this,"destroy",()=>Ln(this)),b(this,"show",()=>Te(this)),b(this,"hide",()=>ye(this)),b(this,"set",(o,i)=>Va(this,o,i)),b(this,"context"),this.context=In(V({},this.context),{locale:{months:{short:[],long:[]},weekdays:{short:[],long:[]}}}),x(this,"mainElement",typeof t=="string"?(a=Ke.memoizedElements.get(t))!=null?a:this.queryAndMemoize(t):t),n&&Ae(this,n)}queryAndMemoize(t){const n=document.querySelector(t);if(!n)throw new Error(B.notFoundSelector(t));return Ke.memoizedElements.set(t,n),n}};b(St,"memoizedElements",new Map);let Ka=St;class qe{constructor(t={}){if(t.containerId)this.selector=`#${t.containerId}`;else if(t.selector)this.selector=t.selector;else{console.error("DateRangePicker: Не указан selector или containerId");return}if(this.container=document.querySelector(this.selector),!this.container){console.error(`DateRangePicker: Контейнер не найден для селектора "${this.selector}"`);return}this.inputElement=this.container.querySelector("input"),this.inputElement||(this.inputElement=document.createElement("input"),this.inputElement.type="text",this.inputElement.className="input input-bordered w-full pr-10",this.inputElement.placeholder=t.placeholder||"Выберите период",this.inputElement.readOnly=!0,this.container.appendChild(this.inputElement)),this.initialTextInputValue=t.initialTextInputValue||"",this.initialTextInputValue&&(this.inputElement.value=this.initialTextInputValue),this.calendar=null,this.selectedDates=[],this.options={minDate:t.minDate||"",maxDate:t.maxDate||"",initialDate:t.initialDate||new Date().toISOString().split("T")[0],locale:"ru-RU"},this.onRangeSelect=t.onRangeSelect||null,this.calendarContainer=document.createElement("div"),this.calendarContainer.className="date-range-picker-popup",this.calendarContainer.style.cssText=`
      position: absolute;
      z-index: 1000;
      background: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-radius: 4px;
      display: none;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
      top: 100%;
      left: 0;
      margin-top: 0.5rem;
      min-width: 320px;
    `,this.calendarContainer.classList.add("flex","flex-col"),this.container.appendChild(this.calendarContainer),this.buttonsContainer=document.createElement("div"),this.buttonsContainer.className="date-range-picker-actions flex gap-2  pt-0 p-2",this.cancelButton=document.createElement("button"),this.cancelButton.type="button",this.cancelButton.className="btn-ghost border-brand-gray border px-8 w-1/2 rounded-lg hover:border-brand-blue",this.cancelButton.textContent="Отмена",this.applyButton=document.createElement("button"),this.applyButton.type="button",this.applyButton.className="btn btn-primary !py-2 w-1/2",this.applyButton.textContent="Применить",this.buttonsContainer.appendChild(this.cancelButton),this.buttonsContainer.appendChild(this.applyButton),this.calendarContainer.appendChild(this.buttonsContainer),this._init(),this._setupEventListeners()}_setupEventListeners(){this.inputElement.addEventListener("click",t=>{t.preventDefault(),this.show()}),document.addEventListener("mousedown",t=>{!this.calendarContainer.contains(t.target)&&t.target!==this.inputElement&&!this.inputElement.contains(t.target)&&this.hide()}),this.cancelButton.addEventListener("click",()=>{this.hide()}),this.applyButton.addEventListener("click",()=>{console.log('Весь объект календаря (при нажатии "Применить"):'),console.dir(this.calendar);try{const t=(n,a)=>n==="parentNode"||n==="ownerDocument"||n==="parent"||n==="previousSibling"||n==="nextSibling"?"[DOM]":typeof a=="function"?"function() { ... }":a;console.log('Структура календаря (при нажатии "Применить"):',JSON.parse(JSON.stringify(this.calendar,t)))}catch(t){console.log('Не удалось сериализовать объект календаря (при нажатии "Применить"):',t)}this._updateSelectedDatesFromCalendar(),this._updateInputValue(),this._notifyRangeSelect(),this.hide()})}_init(){try{this.init()}catch(t){console.error("Ошибка инициализации DateRangePicker:",t)}}init(){const t=document.createElement("div");this.calendarContainer.insertBefore(t,this.buttonsContainer),console.warn("[[DateRangePicker DEBUG]] Initializing Calendar instance...");const n={type:"multiple",displayDatesOutside:!1,dates:{minDate:this.options.minDate,maxDate:this.options.maxDate},settings:{lang:"ru",selection:{enableEdgeDatesOnly:!1},visibility:{weekend:!0,today:!0},selectedDates:this.selectedDates},actions:{selectDates:(a,o)=>{console.log(o.join(", "))},onClickDate:(a,o)=>{console.warn("[[DateRangePicker DEBUG]] onClickDate Invoked!"),console.log("[[DateRangePicker DEBUG]] Calendar instance (self):",a),console.log("[[DateRangePicker DEBUG]] Mouse event:",o),console.log("[[DateRangePicker DEBUG]] self.selectedDates from CALENDAR LIBRARY:",JSON.parse(JSON.stringify(a.selectedDates))),console.log("[[DateRangePicker DEBUG]] this.selectedDates (our internal) BEFORE processing:",JSON.parse(JSON.stringify(this.selectedDates)));try{a.update(),console.log("[[DateRangePicker DEBUG]] Called self.update() after date click.")}catch(i){console.error("[[DateRangePicker DEBUG]] Error calling self.update() in onClickDate:",i.message)}},onChangeToInput:a=>{console.warn("[[DateRangePicker DEBUG]] onChangeToInput Invoked!"),console.log("[[DateRangePicker DEBUG]] Calendar instance (self) in onChangeToInput:",a),console.log("[[DateRangePicker DEBUG]] self.selectedDates in onChangeToInput:",JSON.parse(JSON.stringify(a.selectedDates)));const o=a.selectedDates;Array.isArray(o)&&(this.selectedDates=o.map(i=>{try{if(!i)throw new Error("Date source is null or empty");return new Date(i).toISOString().split("T")[0]}catch(r){return console.error("[[DateRangePicker DEBUG]] Error parsing date in onChangeToInput:",i,"Error:",r.message),null}}).filter(i=>i!==null).sort(),console.log("[[DateRangePicker DEBUG]] this.selectedDates updated from onChangeToInput:",JSON.parse(JSON.stringify(this.selectedDates))))}},popups:{},selectionDatesMode:"multiple-ranged",cssClass:"date-range-picker-calendar",locale:"ru-RU"};console.log("[[DateRangePicker DEBUG]] Calendar options to be used:",JSON.parse(JSON.stringify(n)));try{this.calendar=new Ka(t,n),console.log("[[DateRangePicker DEBUG]] Calendar instance CREATED:",this.calendar),this.calendar&&typeof this.calendar.init=="function"?(this.calendar.init(),console.log("[[DateRangePicker DEBUG]] Calendar instance INITIALIZED."),console.log("[[DateRangePicker DEBUG]] Calendar internal selected dates AFTER init:",this.calendar.selectedDates)):console.error("[[DateRangePicker DEBUG]] Calendar instance is invalid or has no init method!")}catch(a){console.error("[[DateRangePicker DEBUG]] CRITICAL ERROR creating or initializing Calendar instance:",a.message,a.stack)}this._addCustomStyles()}_addCustomStyles(){if(!document.getElementById("date-range-picker-custom-styles")){const t=document.createElement("style");t.id="date-range-picker-custom-styles",t.textContent=`
        .date-range-picker-popup {
          z-index: 1050 !important;
        }
        .date-range-picker-calendar {
          background: white;
          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
          border-radius: 0.5rem;
          padding: 0.5rem;
        }
        .date-range-picker-calendar .vanilla-calendar-header {
          padding: 0.75rem;
        }
        .date-range-picker-calendar .vanilla-calendar-content {
          padding: 0.5rem;
        }
        .date-range-picker-calendar .vanilla-calendar-week__day {
          font-weight: bold;
        }
        
        /* Фиксим конфликт с классами vc- */
        .date-range-picker-calendar .vanilla-calendar-day[data-calendar-day-selected="true"] {
          background-color: var(--color-primary, #008DD2);
          color: white;
          font-weight: bold;
        }
        .date-range-picker-calendar .vanilla-calendar-day[data-calendar-day-selected="true"].vanilla-calendar-day_selected-first {
          border-top-left-radius: 50%;
          border-bottom-left-radius: 50%;
        }
        .date-range-picker-calendar .vanilla-calendar-day[data-calendar-day-selected="true"].vanilla-calendar-day_selected-last {
          border-top-right-radius: 50%;
          border-bottom-right-radius: 50%;
        }
        
        
      `,document.head.appendChild(t)}}_updateSelectedDatesFromCalendar(){if(!this.calendar||!this.calendar.context||!this.calendar.context.selectedDates){console.warn("[[DateRangePicker DEBUG]] Calendar context or selectedDates not found in _updateSelectedDatesFromCalendar. Calendar object:",this.calendar),this.selectedDates=[];return}console.log("Обновляем выбранные даты из экземпляра календаря (this.calendar.context.selectedDates):",this.calendar.context.selectedDates);const t=this.calendar.context.selectedDates;if(Array.isArray(t)&&t.length>0){const n=t.map(a=>{try{if(!a)throw new Error("Date source is null or empty");return new Date(a).toISOString().split("T")[0]}catch(o){return console.error("[[DateRangePicker DEBUG]] Error parsing date in _updateSelectedDatesFromCalendar:",a,"Error:",o.message),null}}).filter(a=>a!==null).sort();this.selectedDates=n,console.log("[[DateRangePicker DEBUG]] Updated internal selectedDates:",this.selectedDates)}else this.selectedDates=[],console.log("[[DateRangePicker DEBUG]] No dates selected, cleared internal selectedDates")}_updateInputValue(){this._updateSelectedDatesFromCalendar();const t=this.getFormattedRange();if(console.log("Updating input value:",{formattedRange:t,selectedDates:this.selectedDates,initialText:this.initialTextInputValue}),this.inputElement){t?this.inputElement.value=t:this.inputElement.value=this.initialTextInputValue||"";const n=new Event("input",{bubbles:!0,cancelable:!0});this.inputElement.dispatchEvent(n)}}_notifyRangeSelect(){if(this._updateSelectedDatesFromCalendar(),this.onRangeSelect&&this.selectedDates.length>=1){const t={start:this.selectedDates[0],end:this.selectedDates[this.selectedDates.length-1]||this.selectedDates[0],formattedRange:this.getFormattedRange(),isEmpty:this.selectedDates.length===0};console.log("Notifying range select:",t),this.onRangeSelect(t)}}getSelectedDates(){return this._updateSelectedDatesFromCalendar(),this.selectedDates}getValue(){if(this._updateSelectedDatesFromCalendar(),this.selectedDates.length>=1){const t={start:this.selectedDates[0],end:this.selectedDates[this.selectedDates.length-1]||this.selectedDates[0],formattedRange:this.getFormattedRange(),isEmpty:!1};return console.log("Getting value:",t),t}return{isEmpty:!0}}getFormattedRange(){if(this.selectedDates.length>=1){const t=new Date(this.selectedDates[0]),n=this.selectedDates.length>1?new Date(this.selectedDates[this.selectedDates.length-1]):t,a=r=>{const s=String(r.getDate()).padStart(2,"0"),l=String(r.getMonth()+1).padStart(2,"0"),d=r.getFullYear();return`${s}.${l}.${d}`},o=a(t),i=a(n);return console.log("Selected dates:",{raw:this.selectedDates,start:t,end:n,formatted:`${o} - ${i}`}),this.selectedDates.length===1?o:`${o} - ${i}`}return""}setSelectedDates(t){!this.calendar||!Array.isArray(t)||(this.selectedDates=t.map(n=>new Date(n).toISOString().split("T")[0]).sort(),console.log("Setting selected dates:",{input:t,processed:this.selectedDates}),this.calendar.selectedDates=this.selectedDates,this.calendar.update(),this._updateInputValue())}clear(){this.calendar&&(this.selectedDates=[],this.calendar.selectedDates=[],this.calendar.update(),this.inputElement.value="",this._notifyRangeSelect())}clearSelection(){this.clear()}destroy(){this.calendar&&(this.calendar.destroy(),this.calendar=null,this.container.innerHTML="")}show(){this.calendar&&(this.calendarContainer.style.display="block",this.calendarContainer.offsetHeight,this.calendarContainer.style.opacity="1",this.calendarContainer.style.visibility="visible",this.calendar.show())}hide(){this.calendar&&(this.calendarContainer.style.opacity="0",this.calendarContainer.style.visibility="hidden",setTimeout(()=>{this.calendarContainer.style.display="none"},200),this.calendar.hide())}getStartDate(){return this._updateSelectedDatesFromCalendar(),this.selectedDates.length>0?this.selectedDates[0]:null}getEndDate(){return this._updateSelectedDatesFromCalendar(),this.selectedDates.length>1?this.selectedDates[this.selectedDates.length-1]:null}}const he="#008DD2",$e="#666666",T={initialView:{center:{desktop:[54.962902,73.38475],mobile:[53.224854,50.199879]},zoom:{desktop:4,mobile:3}},officeZoom:{desktop:12,mobile:10},maxBoundsZoom:{desktop:18,mobile:7},boundsPadding:[50,50],markerSizing:{minZoom:2,maxZoom:18,minSize:[16,18],maxSize:[36,42],minOffset:[-8,-18],maxOffset:[-18,-42]}};function Y(e){const t=`
  <svg width="36" height="42" viewBox="0 0 36 42" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M35.114 14.1578C33.014 4.91781 24.954 0.757812 17.874 0.757812C17.874 0.757812 17.874 0.757812 17.854 0.757812C10.794 0.757812 2.71397 4.89781 0.61397 14.1378C-1.72603 24.4578 4.59397 33.1978 10.314 38.6978C12.434 40.7378 15.154 41.7578 17.874 41.7578C20.594 41.7578 23.314 40.7378 25.414 38.6978C31.134 33.1978 37.454 24.4778 35.114 14.1578ZM17.874 24.1778C14.394 24.1778 11.574 21.3578 11.574 17.8778C11.574 14.3978 14.394 11.5778 17.874 11.5778C21.354 11.5778 24.174 14.3978 24.174 17.8778C24.174 21.3578 21.354 24.1778 17.874 24.1778Z" fill="${e}" />
  </svg>`;return`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(t)}`}function Z(e){const t=Qe();return e[t]}function kt(e){const t=Qe();return e[t]}function _(e){const{minZoom:t,maxZoom:n,minSize:a,maxSize:o,minOffset:i,maxOffset:r}=T.markerSizing;if(e<=t)return{size:a,offset:i};if(e>=n)return{size:o,offset:r};const s=(e-t)/(n-t),l=Math.round(a[0]+(o[0]-a[0])*s),d=Math.round(a[1]+(o[1]-a[1])*s),u=d/o[1],h=Math.round(i[0]+(r[0]-i[0])*u),c=Math.round(i[1]+(r[1]-i[1])*u);return{size:[l,d],offset:[h,c]}}function Be(e){const t=document.querySelector(".map-info-panel");if(!t)return;let n=e.address||"";e.city&&n.trim().startsWith(e.city+",")&&(n=n.replace(e.city+",","").trim()),t.innerHTML=`
    <div class="flex justify-between items-center mb-2">
      <div class="font-bold text-2xl text-brand-gray">${e.city||""}</div>
      <button class="text-brand-gray hover:text-brand-blue transition-colors close-info-panel">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    <div class="text-brand-gray">${n}</div>
    <div class="hidden lg:block text-brand-gray">${e.type||""}</div>
    ${e.phone?`<div class="hidden lg:block text-brand-gray">${e.phone}</div>`:""}
    ${e.email?`<div class="hidden lg:block text-brand-gray">${e.email}</div>`:""}
    <button class="bg-brand-blue mt-2 md:mt-5 text-white rounded-lg py-3 text-buttons text-regular btn">Подробнее</button>
  `,t.classList.remove("hidden");const a=t.querySelector(".close-info-panel");a&&a.addEventListener("click",function(){t.classList.add("hidden"),typeof window.resetAllMarkers=="function"&&window.resetAllMarkers(),L(null)})}function L(e,t=null,n=null,a=null){if(document.querySelectorAll(".office-card").forEach(o=>{o.classList.remove("ring","ring-brand-blue")}),e&&e.classList.add("ring","ring-brand-blue"),t&&Be(t),n&&a&&(typeof window.resetAllMarkers=="function"&&window.resetAllMarkers(),n.options)){const o=a.getZoom(),i=_(o),r=Y(he);n.options.set({iconImageHref:r,iconImageSize:i.size,iconImageOffset:i.offset})}}function me(e,t=null,n=null,a=null,o=null){if(document.querySelectorAll(".office-card").forEach(i=>{i.classList.remove("ring","ring-brand-blue")}),e&&e.classList.add("ring","ring-brand-blue"),t&&Be(t),n&&a){if(typeof window.resetAllMarkers=="function"&&window.resetAllMarkers(),typeof window.setActiveMarker=="function"&&window.setActiveMarker(n),n.options){const i=Z(T.officeZoom),r=_(i),s=Y(he);n.options.set({iconImageHref:s,iconImageSize:r.size,iconImageOffset:r.offset})}if(o){const i=Z(T.officeZoom);a.setCenter(o,i,{duration:300})}}}function te(e,t){try{ymaps.ready(function(){const n=Z(T.initialView.zoom),a=kt(T.initialView.center),o=new ymaps.Map("map",{center:a,zoom:n,controls:["zoomControl","fullscreenControl"],behaviors:["drag","multiTouch","scrollZoom"]});window.currentMap=o,window.mapInstance=o;const i=new ymaps.GeoObjectCollection,r={};window.officeMarkers=r;let s=null;window.setActiveMarker=function(h){s=h},window.getActiveMarker=function(){return s};const l=_(n),d={iconLayout:"default#image",iconImageHref:Y($e),iconImageSize:l.size,iconImageOffset:l.offset};function u(h){const c=_(h);Object.values(r).forEach(m=>{const f=m.options.get("iconImageHref").includes(encodeURIComponent(he));m.options.set({iconImageSize:c.size,iconImageOffset:c.offset})})}window.resetAllMarkers=function(){const h=o.getZoom(),c=_(h);Object.values(r).forEach(m=>{const f=Y($e);m.options.set({iconImageHref:f,iconImageSize:c.size,iconImageOffset:c.offset})})},window.showAllOfficesOnMap=function(h){if(!h||h.length===0)return;const c=h.reduce((m,f)=>m.extend(f),new ymaps.geometry.LineString(h).getBounds());o.setBounds(c,{checkZoomRange:!0,zoomMargin:T.boundsPadding})},e.forEach((h,c)=>{if(!h.coordinates||h.coordinates.length!==2)return;const m=Y($e),f=new ymaps.Placemark(h.coordinates,{hintContent:h.city},{iconLayout:"default#image",iconImageHref:m,iconImageSize:l.size,iconImageOffset:l.offset});r[c]=f,i.add(f),f.events.add("click",()=>{const y=o.getZoom(),E=Z(T.officeZoom),g=Z(T.initialView.zoom),p=Math.abs(y-E)<3;if(!(s===f))L(null,h,f,o),s=f;else if(!p)me(null,h,f,o,f.geometry.getCoordinates());else{const D=o.getCenter(),S=_(g),C=Y(he);o.setZoom(g,{duration:300}),setTimeout(()=>{f&&f.options&&f.options.set({iconImageHref:C,iconImageSize:S.size,iconImageOffset:S.offset})},350)}})}),o.geoObjects.add(i),o.events.add("boundschange",function(h){h.get("oldZoom")!==h.get("newZoom")&&u(h.get("newZoom"))}),i.getLength()>0&&o.setCenter(a,n)})}catch(n){console.error("Ошибка при инициализации карты:",n)}}function It(){if(typeof Swiper>"u"){console.error("Swiper не загружен!");return}if(new Swiper(".swiper-container",{slidesPerView:1,spaceBetween:0,loop:!0,speed:800,effect:"fade",fadeEffect:{crossFade:!0},autoplay:{delay:7e4,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},on:{init:function(){console.log("Swiper инициализирован")}}}),document.querySelector(".news-swiper-container")){console.log("Инициализация Swiper для новостей с уже существующими слайдами...");const e=document.querySelector(".news-swiper-container .swiper-wrapper"),t=e?e.querySelectorAll(".swiper-slide"):[];console.log(`Найдено ${t.length} существующих слайдов новостей от шаблонизатора`),new Swiper(".news-swiper-container",{slidesPerView:1,spaceBetween:30,loop:t.length>1,speed:1100,effect:"fade",fadeEffect:{crossFade:!0},autoplay:{delay:7e3,disableOnInteraction:!1},pagination:{el:".news-swiper-pagination",clickable:!0},navigation:{nextEl:".news-swiper-button-next",prevEl:".news-swiper-button-prev"},breakpoints:{320:{slidesPerView:1,spaceBetween:20},768:{slidesPerView:1,spaceBetween:30}},on:{init:function(){console.log("Swiper новостей инициализирован")}}})}}function Lt(){return new Promise((e,t)=>{try{wn("https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css",n=>{if(n){console.error("Не удалось загрузить стили Swiper:",n),t(n);return}bn("https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js",a=>{if(a){console.error("Не удалось загрузить библиотеку Swiper:",a),t(a);return}console.log("Swiper успешно загружен"),typeof Swiper<"u"?(console.log("Инициализация Swiper..."),setTimeout(()=>{It(),e()},100)):t(new Error("Swiper не определен после загрузки"))})})}catch(n){console.error("Ошибка при загрузке Swiper:",n),t(n)}})}function Pt(){const e=document.getElementById("burger-menu-btn"),t=document.getElementById("mobile-close-btn"),n=document.getElementById("mobile-menu"),a=document.querySelectorAll(".burger-line");if(!n)return;const o=()=>{n.classList.remove("translate-x-full"),n.classList.add("translate-x-0"),a[0].classList.add("rotate-45","translate-y-2"),a[1].classList.add("opacity-0"),a[2].classList.add("-rotate-45","-translate-y-2"),document.body.classList.add("overflow-hidden")},i=()=>{n.classList.remove("translate-x-0"),n.classList.add("translate-x-full"),a[0].classList.remove("rotate-45","translate-y-2"),a[1].classList.remove("opacity-0"),a[2].classList.remove("-rotate-45","-translate-y-2"),document.body.classList.remove("overflow-hidden")};e&&e.addEventListener("click",o),t&&t.addEventListener("click",i)}function At(){const e=document.querySelectorAll(".animated-title"),t=document.querySelectorAll(".animated-subtitle");e.length===0&&t.length===0||setTimeout(()=>{e.forEach(n=>{n.classList.add("show")}),setTimeout(()=>{t.forEach(n=>{n.classList.add("show")})},300)},200)}function Tt(){const e=document.querySelectorAll(".faq-toggle");e.length>0&&e.forEach(t=>{t.addEventListener("click",function(){const n=this.parentElement.querySelector(".faq-content"),a=this.querySelector("svg");n.classList.contains("hidden")?(n.classList.remove("hidden"),a.classList.add("rotate-180")):(n.classList.add("hidden"),a.classList.remove("rotate-180"))})})}function qt(){const e=document.querySelector("form");e&&e.addEventListener("submit",t=>{t.preventDefault(),alert("Форма отправлена!")})}function $t(){console.log("Инициализация табов на странице платежей...");const e=document.querySelectorAll(".payment-tab"),t=document.querySelectorAll(".payment-tab-content");e.length>0&&e.forEach(o=>{o.addEventListener("click",function(){const r=`tab-${this.getAttribute("data-tab")}`;e.forEach(s=>{s.classList.remove("bg-white"),s.classList.add("bg-brand-light","border-transparent","text-brand-gray")}),this.classList.remove("bg-brand-light"),this.classList.add("bg-white","border-transparent","text-brand-gray"),t.forEach(s=>{s.classList.add("hidden")}),document.getElementById(r).classList.remove("hidden")})});const n=document.querySelectorAll(".delivery-tab"),a=document.querySelectorAll(".delivery-tab-content");n.length>0&&n.forEach(o=>{o.addEventListener("click",function(){const r=`tab-${this.getAttribute("data-tab")}`;n.forEach(s=>{s.classList.remove("bg-white"),s.classList.add("bg-brand-light","border-transparent","text-brand-gray")}),this.classList.remove("bg-brand-light"),this.classList.add("bg-white","border-transparent","text-brand-gray"),a.forEach(s=>{s.classList.add("hidden")}),document.getElementById(r).classList.remove("hidden")})})}function Ja(){document.querySelectorAll(".mobile-menu-toggle").forEach(t=>{t.addEventListener("click",function(){const n=this.parentElement.querySelector(".mobile-menu-submenu"),a=this.querySelector("svg");n&&(n.classList.contains("hidden")?(n.classList.remove("hidden"),n.style.maxHeight=n.scrollHeight+"px",a.classList.add("rotate-180")):(n.classList.add("hidden"),n.style.maxHeight=null,a.classList.remove("rotate-180")))})})}function Xa(){document.querySelectorAll('input[type="tel"]').forEach(e=>{new xn(e)})}Xe(()=>{Xa()});function Ne(e,t,n,a,o={}){console.log(`Создание поля автокомплита ${n} с плейсхолдером "${a}"`);const i=e.querySelector("img");let r="";i&&(r=`<img src="${i.src}" alt="" class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none z-10">`);const s=`
    <div class="relative w-full">
      <input 
        id="${n}-input" 
        type="text" 
        class="appearance-none bg-white border border-gray-200 rounded-lg px-4 py-2 w-full focus:outline-none text-body-secondary !pr-8 text-sm"
        placeholder="${a}" 
        autocomplete="off"
        required
      >
      <button type="button" class="absolute right-0 top-0 h-full w-12 text-gray-400 focus:outline-none z-10"></button>
      ${r}
      <ul 
        id="${n}-suggestions" 
        class="absolute w-full bg-white border border-gray-200 rounded-md shadow-md mt-1 max-h-60 overflow-y-auto hidden z-20"
        style=""
      ></ul>
    </div>
  `;e.innerHTML=s,console.log(`Вставлена HTML-разметка для поля ${n}`);const l=document.getElementById(`${n}-input`),d=document.getElementById(`${n}-suggestions`),u=e.querySelector("button");if(!l||!d||!u){console.error(`Не удалось создать элементы автокомплита для ${n}`,{input:!!l,list:!!d,toggleButton:!!u});return}console.log(`Созданы элементы автокомплита для ${n}`);let h=-1;function c(g){return o.onlyCities?g.city:`${g.city}, ${g.address}${g.phone?", "+g.phone:""}`}function m(g){return o.onlyCities?`
        <div style="line-height:1.3; padding:2px 0;">
          <div style="font-weight:bold;">${g.city}</div>
        </div>
      `:`
      <div style="line-height:1.3; padding:2px 0;">
        <div style="font-weight:bold;">${g.city}</div>
        <div>${g.address}</div>
        <div style="color:#888; font-size:0.95em;">${g.type||""}</div>
        <div style="color:#008DD2; font-size:0.98em;">${g.phone||""}</div>
      </div>
    `}function f(g){const p=g.toLowerCase().trim();if(o.onlyCities){const C=new Map,k=new Map,P=new Map;return t.forEach($=>{if($.city){const yn=$.city.trim().toLowerCase();P.has(yn)||P.set(yn,$)}}),P.forEach(($,F)=>{F.startsWith(p)?C.set(F,$):F.includes(p)&&k.set(F,$)}),[...C.values(),...k.values()]}const w=[],D=[],S=[];return t.forEach(C=>{C.city&&C.city.toLowerCase().startsWith(p)?w.push(C):C.city&&C.city.toLowerCase().includes(p)?D.push(C):(C.address&&C.address.toLowerCase().includes(p)||C.type&&C.type.toLowerCase().includes(p)||C.phone&&C.phone.toLowerCase().includes(p))&&S.push(C)}),[...w,...D,...S]}function y(g){d.innerHTML="",h=-1,g.forEach((p,w)=>{const D=document.createElement("li");D.innerHTML=m(p),D.className="px-4 py-2 hover:bg-blue-100 cursor-pointer",D.addEventListener("click",()=>{l.value=c(p),d.classList.add("hidden"),o.onlyCities&&Promise.resolve().then(()=>{const S=new CustomEvent("citySelected",{detail:{city:p.city}});l.dispatchEvent(S)})}),d.appendChild(D)}),d.classList.remove("hidden")}function E(){if(d.innerHTML="",h=-1,o.onlyCities){const g=new Map;t.forEach(p=>{if(p.city){const D=p.city.trim().toLowerCase();g.has(D)||g.set(D,p)}}),g.forEach((p,w)=>{const D=document.createElement("li");D.innerHTML=m(p),D.className="px-4 py-2 hover:bg-blue-100 cursor-pointer",D.addEventListener("click",()=>{l.value=c(p),d.classList.add("hidden"),o.onlyCities&&Promise.resolve().then(()=>{const S=new CustomEvent("citySelected",{detail:{city:p.city}});l.dispatchEvent(S)})}),d.appendChild(D)})}else t.forEach((g,p)=>{const w=document.createElement("li");w.innerHTML=m(g),w.className="px-4 py-2 hover:bg-blue-100 cursor-pointer",w.addEventListener("click",()=>{l.value=c(g),d.classList.add("hidden"),o.onlyCities&&Promise.resolve().then(()=>{const D=new CustomEvent("citySelected",{detail:{city:g.city}});l.dispatchEvent(D)})}),d.appendChild(w)});d.classList.remove("hidden")}u.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),d.classList.contains("hidden")?E():d.classList.add("hidden")}),l.addEventListener("input",()=>{const g=l.value.trim();if(!g){d.classList.add("hidden");return}const p=f(g);if(p.length===0){d.classList.add("hidden");return}y(p)}),l.addEventListener("keydown",g=>{const p=d.querySelectorAll("li");if(d.classList.contains("hidden")||p.length===0){if(g.key==="ArrowDown"&&l.value.trim()===""){g.preventDefault(),E();return}return}if(g.key==="ArrowDown")g.preventDefault(),h=(h+1)%p.length,Bt(p);else if(g.key==="ArrowUp")g.preventDefault(),h=(h-1+p.length)%p.length,Bt(p);else if(g.key==="Enter"){if(g.preventDefault(),h>=0&&h<p.length){const w=f(l.value.trim())[h]||t[h];w&&(l.value=c(w)),d.classList.add("hidden")}}else g.key==="Escape"&&(g.preventDefault(),d.classList.add("hidden"))}),document.addEventListener("click",g=>{!d.contains(g.target)&&g.target!==l&&g.target!==u&&d.classList.add("hidden")}),l.addEventListener("focus",()=>{const g=l.value.trim();if(!g)return;const p=f(g);p.length>0&&y(p)}),d.style.maxHeight="200px",d.style.overflowY="auto",d.style.overscrollBehavior="contain"}function Bt(e){if(e.forEach((t,n)=>{t.classList.toggle("bg-blue-100",n===currentIndex)}),currentIndex>=0){const t=e[currentIndex],n=list.getBoundingClientRect(),a=t.getBoundingClientRect();a.bottom>n.bottom?t.scrollIntoView(!1):a.top<n.top&&t.scrollIntoView(!0)}}function Nt(){console.log("Инициализация главной страницы начата"),document.querySelector(".swiper-container")||document.querySelector(".news-swiper-container")?(console.log("Обнаружен контейнер Swiper, начинаю загрузку..."),Lt().catch(h=>{console.error("Не удалось загрузить Swiper:",h)})):console.log("Контейнеры Swiper не обнаружены на странице"),console.log("Используем новости, уже загруженные через шаблонизатор");const e=document.querySelector(".news-carousel"),t=document.querySelector(".news-carousel button.absolute.left-0"),n=document.querySelector(".news-carousel button.absolute.right-0");if(e&&t&&n){const h=e.querySelectorAll(".bg-brand-light");let c=0;const m=f=>{h.forEach(y=>{y.style.display="none"}),h[f].style.display="block"};t.addEventListener("click",()=>{c=(c-1+h.length)%h.length,m(c)}),n.addEventListener("click",()=>{c=(c+1)%h.length,m(c)}),m(c)}const a=document.querySelectorAll(".carousel-slide"),o=document.querySelector(".carousel-container .absolute.left-4"),i=document.querySelector(".carousel-container .absolute.right-4");if(a.length>0&&o&&i){let h=0;const c=m=>{a.forEach(f=>{f.classList.remove("active"),f.style.display="none"}),a[m].classList.add("active"),a[m].style.display="block"};o.addEventListener("click",()=>{h=(h-1+a.length)%a.length,c(h)}),i.addEventListener("click",()=>{h=(h+1)%a.length,c(h)}),c(h),setInterval(()=>{h=(h+1)%a.length,c(h)},5e3)}const r=document.querySelector(".track-form");if(r)r.addEventListener("submit",function(h){h.preventDefault();const c=this.querySelector('input[type="text"]').value;c.trim()!==""?(console.log("Отслеживание заказа:",c),alert(`Отслеживание заказа: ${c}`)):(console.warn("Пустой ввод в форме отслеживания заказа"),alert("Пожалуйста, введите номер заказа"))});else{const h=document.querySelector(".tracking-form-container, .p-4.rounded-lg.w-full.md\\:w-2\\/5");if(h){console.log("Найден контейнер формы отслеживания");const c=h.querySelectorAll("button");console.log(`В контейнере формы отслеживания найдено ${c.length} кнопок:`),c.forEach((f,y)=>{console.log(`Кнопка #${y+1}:`,{classes:f.className,text:f.textContent.trim()})});let m=h.querySelector("button.bg-brand-gray");m||(console.log('Не найдена кнопка по классу, ищем по тексту "Поиск"'),m=Array.from(h.querySelectorAll("button")).find(y=>y.textContent.trim().toLowerCase().includes("поиск"))),m?(console.log('Найдена кнопка "Поиск" для отслеживания:',{text:m.textContent.trim(),classes:m.className}),m.addEventListener("click",function(f){f.preventDefault(),console.log('Клик по кнопке "Поиск" для отслеживания');const y=h.querySelector('input[type="text"]');if(!y){console.error("Не найдено поле ввода для формы отслеживания");return}y.hasAttribute("required")||y.setAttribute("required",""),y.validity.valid?(console.log("Отслеживание номера:",y.value),alert(`Отслеживание номера: ${y.value}`)):y.reportValidity()})):console.warn('Не найдена кнопка "Поиск" в контейнере формы отслеживания')}else console.warn("Не найден контейнер формы отслеживания")}Qa();const s=document.querySelector(".price-form");let l=!1;if(s&&(l=!0,s.addEventListener("submit",function(h){if(h.preventDefault(),this.checkValidity()){const c=document.querySelector("#from-city-input"),m=document.querySelector("#to-city-input");console.log("Расчет стоимости доставки:",{from:c.value,to:m.value}),alert(`Расчет стоимости доставки: ${c.value} -> ${m.value}`)}else this.reportValidity()})),!l){const h=document.querySelector(".bg-brand-light.p-4.rounded-lg.w-full.md\\:w-3\\/5");if(h){console.log("Найден контейнер формы расчета, будем использовать клик по кнопке");const c=h.querySelectorAll("button");console.log(`В контейнере формы расчета найдено ${c.length} кнопок:`),c.forEach((f,y)=>{console.log(`Кнопка #${y+1}:`,{classes:f.className,text:f.textContent.trim()})});let m=h.querySelector("button.bg-brand-gray");m||(console.log('Не найдена кнопка по классу, ищем по тексту "Рассчитать"'),m=Array.from(h.querySelectorAll("button")).find(y=>y.textContent.trim().toLowerCase().includes("рассчитать"))),m?(console.log('Найдена кнопка "Рассчитать" для расчета стоимости:',{text:m.textContent.trim(),classes:m.className}),m.addEventListener("click",function(f){f.preventDefault(),console.log('Клик по кнопке "Рассчитать"');const y=document.querySelector("#from-city-input"),E=document.querySelector("#to-city-input");if(!y||!E){console.error("Не найдены поля ввода для формы расчета");return}y.validity.valid&&E.validity.valid?(console.log("Расчет стоимости доставки:",{from:y.value,to:E.value}),alert(`Расчет стоимости доставки: ${y.value} -> ${E.value}`)):y.validity.valid?E.validity.valid||E.reportValidity():y.reportValidity()})):console.warn('Не найдена кнопка "Рассчитать" в контейнере формы расчета')}}const d=document.getElementById("become-client-btn");d&&d.addEventListener("click",function(){I.open("become-client-modal",{onOpen:h=>{const c=h.querySelector("#become-client-form");c&&c.addEventListener("submit",function(m){if(m.preventDefault(),this.checkValidity()){const f={name:document.getElementById("client-name").value,phone:document.getElementById("client-phone").value,email:document.getElementById("client-email").value,type:document.getElementById("client-type").value,comment:document.getElementById("client-comment").value};console.log("Заявка на становление клиентом:",f),alert(`Спасибо за заявку, ${f.name}! Мы свяжемся с вами в ближайшее время.`),I.close(h),this.reset()}else this.reportValidity()})}})});const u=document.querySelector("form.space-y-4");u&&(u.querySelectorAll('input[type="text"], input[type="tel"], input[type="checkbox"]').forEach(c=>{c.hasAttribute("required")||c.setAttribute("required","")}),u.addEventListener("submit",function(c){if(c.preventDefault(),this.checkValidity()){const m=this.querySelector('input[type="text"]').value,f=this.querySelector('input[type="tel"]').value;alert(`Спасибо за заявку, ${m}! Мы свяжемся с вами по номеру ${f}`),this.reset()}else this.reportValidity()})),console.log("Инициализация главной страницы завершена")}function Qa(){console.log("Инициализация автокомплита для полей выбора объектов");let e=[];if(window.officesData&&window.officesData.length>0)e=window.officesData,console.log("Используем офисы из window.officesData:",e.length);else{const t=document.querySelectorAll("#offices-data .office-data");e=Array.from(t).map(n=>({city:n.dataset.city,address:n.dataset.address,type:n.dataset.type,phone:n.dataset.phone,email:n.dataset.email,coordinates:n.dataset.coordinates})),console.log("Офисы из DOM:",e.length)}eo(e),to()}function eo(e){console.log("Настройка полей ввода с автокомплитом для офисов");const t=document.querySelector("select.from").closest(".relative.w-full"),n=document.querySelector("select.to").closest(".relative.w-full");if(!t||!n){console.error("Не найдены контейнеры для полей выбора объектов");return}Ne(t,e,"from-city","Откуда"),Ne(n,e,"to-city","Куда")}function to(e){document.querySelectorAll(".flex.md\\:flex-row.flex-col .flex.flex-row.flex-wrap.gap-2").forEach((n,a)=>{const o=document.getElementById(a===0?"from-city-input":"to-city-input");o&&n.querySelectorAll("span").forEach(i=>{i.addEventListener("click",()=>{const r=i.textContent.trim();o.value=r,o.focus(),setTimeout(()=>{o.dispatchEvent(new Event("focus",{bubbles:!0})),o.dispatchEvent(new Event("input",{bubbles:!0}))},50)})})})}class ge{constructor(t){console.log("Pagination: Создание экземпляра пагинации"),this.containerSelector=t.containerSelector,this.itemSelector=t.itemSelector,this.paginationSelector=t.paginationSelector,this.itemsPerPage=t.itemsPerPage||9,this.onPageChange=t.onPageChange||null,this.afterPageRender=t.afterPageRender||null,this.beforePageChange=t.beforePageChange||null,this.filterSelector=t.filterSelector||null,this.filterAttribute=t.filterAttribute||"data-filter",this.useDisplayNone=t.useDisplayNone||!1,this.container=document.querySelector(this.containerSelector),this.paginationContainer=document.querySelector(this.paginationSelector),console.log("Pagination: Найден контейнер:",this.container!==null),console.log("Pagination: Найден контейнер пагинации:",this.paginationContainer!==null),this.currentPage=1,this.allItems=[],this.filteredItems=[],this.totalPages=0,this.container&&this.paginationContainer?this.init():(console.error("Pagination: Не удалось найти контейнер или контейнер пагинации"),console.error(`Pagination: Контейнер "${this.containerSelector}" найден: ${this.container!==null}`),console.error(`Pagination: Контейнер пагинации "${this.paginationSelector}" найден: ${this.paginationContainer!==null}`))}init(){try{console.log("Pagination: Начало инициализации"),this.allItems=Array.from(document.querySelectorAll(this.itemSelector)),console.log("Pagination: Найдено элементов:",this.allItems.length),this.filteredItems=[...this.allItems],this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage),console.log("Pagination: Общее количество страниц:",this.totalPages),this.createPaginationElements(),this.showPage(1),this.filterSelector&&this.initFilter(),console.log("Pagination: Инициализация завершена успешно")}catch(t){console.error("Pagination: Ошибка при инициализации:",t)}}createPaginationElements(){try{if(console.log("Pagination: Создание элементов пагинации"),this.paginationContainer.innerHTML="",this.totalPages<=1){console.log("Pagination: Всего одна страница, пагинация не требуется");return}const t=document.createElement("nav");t.className="inline-flex items-center justify-center space-x-2",t.setAttribute("aria-label","Pagination");const n=document.createElement("button");n.className="pagination-prev pagination-button flex items-center justify-center rounded bg-brand-light text-brand-gray hover:bg-brand-blue hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors w-8 h-8",n.innerHTML="&lt;",n.disabled=!0,n.setAttribute("aria-label","Предыдущая страница"),n.addEventListener("click",()=>{this.currentPage>1&&this.showPage(this.currentPage-1)}),t.appendChild(n),this.updatePaginationButtons(1,this.totalPages,t,n);const a=document.createElement("button");a.className="pagination-next pagination-button flex items-center justify-center rounded bg-brand-light text-brand-gray hover:bg-brand-blue hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors w-8 h-8",a.innerHTML="&gt;",a.setAttribute("aria-label","Следующая страница"),this.totalPages<=1&&(a.disabled=!0),a.addEventListener("click",()=>{this.currentPage<this.totalPages&&this.showPage(this.currentPage+1)}),t.appendChild(a);const o=document.createElement("div");o.className="flex justify-center items-center w-full",o.appendChild(t),this.paginationContainer.appendChild(o),console.log("Pagination: Элементы пагинации созданы успешно")}catch(t){console.error("Pagination: Ошибка при создании элементов пагинации:",t)}}updatePaginationButtons(t,n,a,o){try{a.querySelectorAll(".pagination-number, .pagination-ellipsis").forEach(s=>s.remove());const r=a.querySelector(".pagination-next");if(n<=7)for(let s=1;s<=n;s++)this.addPageButton(s,t,a,r);else{this.addPageButton(1,t,a,r);let s,l;if(t<=4){s=2,l=5;for(let d=s;d<=l;d++)this.addPageButton(d,t,a,r);this.addEllipsis(a,r),this.addPageButton(n,t,a,r)}else if(t>=n-3){s=n-4,l=n-1,this.addEllipsis(a,r);for(let d=s;d<=l;d++)this.addPageButton(d,t,a,r);this.addPageButton(n,t,a,r)}else{this.addEllipsis(a,r);for(let d=t-1;d<=t+1;d++)this.addPageButton(d,t,a,r);this.addEllipsis(a,r),this.addPageButton(n,t,a,r)}}o&&(t===1?(o.setAttribute("disabled","disabled"),o.classList.add("opacity-50","cursor-not-allowed")):(o.removeAttribute("disabled"),o.classList.remove("opacity-50","cursor-not-allowed"))),r&&(t===n||n===0?(r.setAttribute("disabled","disabled"),r.classList.add("opacity-50","cursor-not-allowed")):(r.removeAttribute("disabled"),r.classList.remove("opacity-50","cursor-not-allowed")))}catch(i){console.error("Pagination: Ошибка при обновлении кнопок пагинации:",i)}}addPageButton(t,n,a,o){const i=document.createElement("button");t===n?i.className="pagination-number pagination-button flex items-center justify-center rounded bg-brand-blue text-white font-bold w-8 h-8":i.className="pagination-number pagination-button flex items-center justify-center rounded bg-brand-light text-brand-gray hover:bg-brand-blue hover:text-white transition-colors w-8 h-8",i.textContent=t,i.addEventListener("click",()=>{const r=parseInt(i.textContent);this.showPage(r)}),a.insertBefore(i,o)}addEllipsis(t,n){const a=document.createElement("span");a.className="pagination-ellipsis flex items-center justify-center w-8 h-8 text-brand-gray",a.textContent="...",t.insertBefore(a,n)}showPage(t){try{console.log("Pagination: Показ страницы",t),this.beforePageChange&&this.beforePageChange(t),this.allItems.forEach(i=>{this.useDisplayNone?i.style.display="none":i.classList.add("hidden")});const n=(t-1)*this.itemsPerPage,a=n+this.itemsPerPage;this.filteredItems.slice(n,a).forEach(i=>{this.useDisplayNone?i.style.display="":i.classList.remove("hidden")});const o=this.paginationContainer.querySelector("nav");if(o){const i=o.querySelector(".pagination-prev");this.updatePaginationButtons(t,this.totalPages,o,i)}this.currentPage=t,this.onPageChange&&this.onPageChange(t),this.afterPageRender&&this.afterPageRender(t),console.log("Pagination: Страница",t,"показана успешно")}catch(n){console.error("Pagination: Ошибка при показе страницы:",n)}}initFilter(){try{console.log("Pagination: Инициализация фильтра");const t=document.querySelector(this.filterSelector);t?(console.log("Pagination: Фильтр найден:",this.filterSelector),t.addEventListener("change",()=>{const n=t.value;console.log("Pagination: Выбрано значение фильтра:",n),n==="all"?this.filteredItems=[...this.allItems]:this.filteredItems=this.allItems.filter(a=>{const o=a.getAttribute(this.filterAttribute);return o===n||(o==null?void 0:o.includes(n))}),console.log("Pagination: Отфильтровано элементов:",this.filteredItems.length),this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage),this.createPaginationElements(),this.showPage(1)})):console.warn("Pagination: Фильтр не найден:",this.filterSelector)}catch(t){console.error("Pagination: Ошибка при инициализации фильтра:",t)}}updateItems(){try{console.log("Pagination: Обновление элементов"),this.allItems=Array.from(document.querySelectorAll(this.itemSelector)),this.filteredItems=[...this.allItems],console.log("Pagination: Обновлено элементов:",this.allItems.length),this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage),this.createPaginationElements(),this.showPage(1)}catch(t){console.error("Pagination: Ошибка при обновлении элементов:",t)}}updateVisibleItems(){try{console.log("Pagination: Обновление видимых элементов"),this.filteredItems=this.allItems.filter(t=>this.useDisplayNone?t.style.display!=="none":!t.classList.contains("hidden")),console.log("Pagination: Видимых элементов:",this.filteredItems.length),this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage),this.createPaginationElements(),this.showPage(1)}catch(t){console.error("Pagination: Ошибка при обновлении видимых элементов:",t)}}applyFilter(t){try{console.log("Pagination: Программное применение фильтра:",t);const n=document.querySelector(this.filterSelector);if(n){n.value=t;const a=new Event("change");n.dispatchEvent(a)}else console.warn("Pagination: Не удалось применить фильтр - элемент не найден:",this.filterSelector)}catch(n){console.error("Pagination: Ошибка при программном применении фильтра:",n)}}resetFilter(){try{console.log("Pagination: Сброс фильтра"),document.querySelector(this.filterSelector)?(this.filteredItems=[...this.allItems],this.totalPages=Math.ceil(this.filteredItems.length/this.itemsPerPage),this.createPaginationElements(),this.showPage(1),console.log("Pagination: Фильтр сброшен успешно")):console.warn("Pagination: Не удалось сбросить фильтр - элемент не найден:",this.filterSelector)}catch(t){console.error("Pagination: Ошибка при сбросе фильтра:",t)}}}let z=null;function Ft(){const e=document.querySelectorAll(".office-card"),t=document.querySelector(".selected-office-card"),n=document.getElementById("close-selected-office");if(L(null),n&&t&&n.addEventListener("click",function(){t.style.display="none",L(null)}),no(),e.length>0){e.forEach((o,i)=>{o.addEventListener("mouseenter",function(){this.classList.add("shadow-md"),this.style.transform="translateY(-2px)",this.style.transition="transform 0.2s ease, box-shadow 0.2s ease"}),o.addEventListener("mouseleave",function(){this.classList.remove("shadow-md"),this.style.transform="translateY(0)"}),o.addEventListener("click",function(r){var d,u,h,c,m,f,y,E,g,p;if(r.target.tagName==="A"&&r.target.getAttribute("href")==="#map"){console.log('Клик по ссылке "Посмотреть на карте", индекс:',i);const w={city:o.dataset.city||((d=o.querySelector("h3"))==null?void 0:d.textContent.trim()),address:(u=o.querySelector(".text-brand-gray"))==null?void 0:u.textContent.trim(),type:(h=o.querySelectorAll(".text-brand-gray")[1])==null?void 0:h.textContent.trim(),phone:(c=o.querySelectorAll(".text-brand-gray")[2])==null?void 0:c.textContent.trim(),email:(m=o.querySelectorAll(".text-brand-gray")[3])==null?void 0:m.textContent.trim()},D=o.dataset.coordinates?o.dataset.coordinates.split(",").map(S=>parseFloat(S.trim())):null;D&&D.length===2&&(typeof ymaps<"u"?ymaps.ready(()=>{var C;let S=(C=document.querySelector("#map"))==null?void 0:C.__yamap;if(!S&&window.mapInstance&&(S=window.mapInstance),!S&&window.currentMap&&(S=window.currentMap),S&&window.officeMarkers&&window.officeMarkers[i]){me(o,w,window.officeMarkers[i],S,D);const k=window.officeMarkers[i];k&&k.events&&typeof window.setActiveMarker=="function"&&window.setActiveMarker(k)}else if(window.officeMarkers&&window.officeMarkers[i]){const k=window.officeMarkers[i];k&&k.events&&k.events.fire("click"),L(o,w)}else L(o,w)}):L(o,w));return}r.preventDefault(),console.log("Клик по карточке офиса, индекс:",i);const s={city:o.dataset.city||((f=o.querySelector("h3"))==null?void 0:f.textContent.trim()),address:(y=o.querySelector(".text-brand-gray"))==null?void 0:y.textContent.trim(),type:(E=o.querySelectorAll(".text-brand-gray")[1])==null?void 0:E.textContent.trim(),phone:(g=o.querySelectorAll(".text-brand-gray")[2])==null?void 0:g.textContent.trim(),email:(p=o.querySelectorAll(".text-brand-gray")[3])==null?void 0:p.textContent.trim()};console.log("Данные офиса:",s);const l=o.dataset.coordinates?o.dataset.coordinates.split(",").map(w=>parseFloat(w.trim())):null;console.log("Координаты:",l),console.log("Доступны ли Яндекс.Карты:",typeof ymaps<"u"),console.log("Доступны ли маркеры:",!!window.officeMarkers),l&&l.length===2?typeof ymaps<"u"?ymaps.ready(()=>{var D,S;let w=(D=document.querySelector("#map"))==null?void 0:D.__yamap;if(!w&&window.mapInstance&&(w=window.mapInstance),!w&&window.currentMap&&(w=window.currentMap),console.log("Экземпляр карты:",!!w),console.log("Маркер для индекса",i,":",!!((S=window.officeMarkers)!=null&&S[i])),w&&window.officeMarkers&&window.officeMarkers[i]){console.log("Вызываем selectOfficeCard с приближением"),me(o,s,window.officeMarkers[i],w,l);const C=window.officeMarkers[i];C&&C.events&&(console.log("Устанавливаем маркер как активный"),typeof window.setActiveMarker=="function"&&window.setActiveMarker(C))}else if(window.officeMarkers&&window.officeMarkers[i]){console.log("Карта не найдена, но маркер есть - пробуем прямой вызов функции маркера");const C=window.officeMarkers[i];C&&C.events&&C.events.fire("click"),L(o,s)}else console.log("Карта не готова, используем selectOfficeCardNoFocus"),L(o,s)}):(console.log("Яндекс.Карты не загружены"),L(o,s)):console.log("Некорректные координаты")})});const a=document.querySelector(".map-info-panel");a&&a.classList.add("hidden"),setTimeout(()=>{var i;const o=(i=window.initialData)==null?void 0:i.defaultOffice;o&&(console.log("Показываем офис по умолчанию"),L(null,o))},1e3)}ao()}function no(){var i;const e=document.querySelector(".form .relative.w-full");if(!e)return;const t=((i=window.initialData)==null?void 0:i.offices)||[];Array.from(new Set(t.map(r=>r.city&&r.city.trim()))).filter(Boolean),Ne(e,t,"city-filter","Все города",{onlyCities:!0});const n=document.getElementById("city-filter-input");if(!n)return;const a=document.getElementById("city-filter-reset");a&&a.addEventListener("click",()=>{var s;n.value="",z?z.resetFilter():document.querySelectorAll(".office-card").forEach(l=>{l.classList.remove("hidden")}),Ot("Все города");const r=(s=window.initialData)==null?void 0:s.defaultOffice;r&&L(null,r)});function o(r){var l;console.log("Фильтрация по городу:",r),r==="Все города"?z?z.resetFilter():document.querySelectorAll(".office-card").forEach(d=>{d.classList.remove("hidden")}):z?z.applyFilter(r):document.querySelectorAll(".office-card").forEach(d=>{(d.dataset.city?d.dataset.city.trim():"")===r.trim()?d.classList.remove("hidden"):d.classList.add("hidden")}),Ot(r);const s=(l=window.initialData)==null?void 0:l.defaultOffice;s&&L(null,s)}n.addEventListener("citySelected",function(r){o(r.detail.city)})}function Ot(e){typeof ymaps>"u"||ymaps.ready(function(){var n;if((n=document.querySelector("#map"))!=null&&n.__yamap)if(typeof window.resetAllMarkers=="function"&&window.resetAllMarkers(),e==="Все города"){const a=[];document.querySelectorAll(".office-card").forEach(o=>{if(o.dataset.coordinates){const i=o.dataset.coordinates.split(",").map(r=>parseFloat(r.trim()));i.length===2&&a.push(i)}}),typeof window.showAllOfficesOnMap=="function"&&a.length>0&&window.showAllOfficesOnMap(a)}else{const a=[];document.querySelectorAll(".office-card").forEach(o=>{if(o.dataset.city===e&&o.dataset.coordinates){const r=o.dataset.coordinates.split(",").map(s=>parseFloat(s.trim()));r.length===2&&a.push(r)}}),typeof window.showAllOfficesOnMap=="function"&&a.length>0&&window.showAllOfficesOnMap(a)}})}function ao(){document.querySelector(".pagination-container")&&(z=new ge({containerSelector:".offices-grid",itemSelector:".office-card",paginationSelector:".pagination-container",itemsPerPage:9,filterSelector:"#city-filter-input",filterAttribute:"data-city",beforePageChange:t=>{L(null)},afterPageRender:t=>{setTimeout(()=>{var a;const n=(a=window.initialData)==null?void 0:a.defaultOffice;n&&L(null,n)},100)}}))}function Rt(){console.log("VacanciesPage: Начало инициализации");const e=document.querySelectorAll(".vacancy-toggle");console.log("VacanciesPage: Найдено кнопок для вакансий:",e.length),e.length>0?(e.forEach(t=>{t.addEventListener("click",function(){const n=this.parentElement.querySelector(".vacancy-content"),a=this.querySelector("svg");n.classList.contains("hidden")?(n.classList.remove("hidden"),a.classList.add("rotate-180")):(n.classList.add("hidden"),a.classList.remove("rotate-180"))})}),console.log("VacanciesPage: Инициализация пагинации с задержкой..."),setTimeout(()=>{oo()},100)):console.warn("VacanciesPage: Не найдены кнопки для вакансий"),console.log("VacanciesPage: Инициализация завершена")}function oo(){console.log("VacanciesPage: Проверка контейнеров для пагинации...");const e=document.querySelector(".vacancies-container"),t=document.querySelectorAll(".vacancy-item"),n=document.querySelector(".pagination-container");if(console.log("VacanciesPage: Найден контейнер для вакансий:",e!==null),console.log("VacanciesPage: Найдено элементов вакансий:",t.length),console.log("VacanciesPage: Найден контейнер для пагинации:",n!==null),e&&t.length>0&&n){if(t.length<=5){console.log("VacanciesPage: Пагинация не требуется, количество элементов не превышает лимит на странице");return}new ge({containerSelector:".vacancies-container",itemSelector:".vacancy-item",paginationSelector:".pagination-container",itemsPerPage:5,filterSelector:"#cityFilter",filterAttribute:"data-location",useDisplayNone:!0}),console.log("VacanciesPage: Пагинация успешно инициализирована")}else console.error("VacanciesPage: Невозможно инициализировать пагинацию - отсутствуют необходимые элементы")}function Ht(){console.log("Инициализация страницы платежей..."),Tt(),$t();const e=document.getElementById("send-check-email"),t=document.getElementById("email-field"),n=document.getElementById("email-input");e&&t&&n&&(console.log("Инициализация функционала отображения поля email..."),e.checked&&(t.classList.remove("hidden"),n.setAttribute("required","")),e.addEventListener("change",function(){this.checked?(t.classList.remove("hidden"),n.setAttribute("required","")):(t.classList.add("hidden"),n.removeAttribute("required"))}));const a=document.getElementById("payment-form");a&&(console.log("Инициализация обработчика формы оплаты..."),a.addEventListener("submit",function(i){i.preventDefault();const r=document.getElementById("order-number").value,s=document.getElementById("send-check-email").checked;let l=null;if(!r){alert("Пожалуйста, введите номер заказа");return}if(s){if(l=document.getElementById("email-input").value,!l){alert("Пожалуйста, введите email для отправки чека");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)){alert("Пожалуйста, введите корректный email");return}}console.log("Отправка платежа:"),console.log("Номер заказа:",r),console.log("Отправить чек на email:",s),s&&console.log("Email для чека:",l),alert("Платеж отправлен! Проверьте консоль для деталей.")}));const o=document.getElementById("order-hint-trigger");if(o){let i=!1;o.addEventListener("click",function(r){r.stopPropagation(),i=!i,i?this.setAttribute("data-tip-show","true"):this.removeAttribute("data-tip-show")}),document.addEventListener("click",function(r){i&&!o.contains(r.target)&&(o.removeAttribute("data-tip-show"),i=!1)}),o.addEventListener("mouseleave",function(){this.removeAttribute("data-tip-show"),i=!1})}}console.log("NewsPage: Модуль загружается...");class io{constructor(){console.log("NewsPage: Инициализация класса"),this.modal=document.getElementById("news-modal"),this.pagination=null,this.dateFilterPicker=null,this.currentFilters={dateRange:null},this.init()}init(){console.log("NewsPage: Начало инициализации"),this.sortNewsByDate(),this.bindNewsDetailsButtons(),this.initDateFilter(),this.initClearFiltersButton(),console.log("NewsPage: Инициализация пагинации..."),this.initPagination(),console.log("NewsPage: Инициализация завершена")}initPagination(){const t=document.querySelector(".news-grid"),n=document.querySelectorAll(".news-card"),a=document.querySelector(".pagination-container");if(console.log("NewsPage: Контейнер для новостей найден:",!!t),console.log("NewsPage: Найдено новостей:",n.length),console.log("NewsPage: Контейнер для пагинации найден:",!!a),!t||n.length===0||!a){console.error("NewsPage: Не удалось найти необходимые элементы для пагинации");return}this.pagination=new ge({containerSelector:".news-grid",itemSelector:".news-card",paginationSelector:".pagination-container",itemsPerPage:5,useDisplayNone:!1}),console.log("NewsPage: Пагинация инициализирована")}initDateFilter(){console.log("NewsPage: Инициализация фильтра дат"),this.dateFilterPicker=new qe({containerId:"news-date-filter-container",inputId:"news-date-filter",placeholder:"Выберите период для фильтрации",autoApply:!1,defaultRange:!0,onRangeSelect:t=>{console.log("NewsPage: Получен диапазон дат:",t),this.currentFilters.dateRange=t,this.applyFilters()}})}initClearFiltersButton(){const t=document.getElementById("clear-filters-btn");t&&t.addEventListener("click",()=>{this.clearAllFilters()})}clearAllFilters(){this.dateFilterPicker&&this.dateFilterPicker.clearSelection(),this.currentFilters={dateRange:null},this.applyFilters()}applyFilters(){const t=document.querySelectorAll(".news-card");console.log("NewsPage: Применение фильтров:",this.currentFilters),console.log("NewsPage: Найдено карточек новостей:",t.length);let n=0;t.forEach((a,o)=>{let i=!0;if(this.currentFilters.dateRange&&!this.currentFilters.dateRange.isEmpty){const r=parseInt(a.dataset.timestamp);if(console.log(`NewsPage: Карточка ${o+1} - timestamp:`,r),r){const s=new Date(r*1e3),l=this.currentFilters.dateRange.startDate,d=this.currentFilters.dateRange.endDate||this.currentFilters.dateRange.startDate,u=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())),h=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate())),c=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate()));console.log(`NewsPage: Карточка ${o+1} - сравнение дат:`,{cardDate:u.toISOString().split("T")[0],startDate:h.toISOString().split("T")[0],endDate:c.toISOString().split("T")[0],cardTime:u.getTime(),startTime:h.getTime(),endTime:c.getTime()});const m=u.getTime(),f=h.getTime(),y=c.getTime();m<f||m>y?(i=!1,console.log(`NewsPage: Карточка ${o+1} скрыта - не попадает в диапазон`)):console.log(`NewsPage: Карточка ${o+1} видима - попадает в диапазон`)}else console.log(`NewsPage: Карточка ${o+1} - нет timestamp, скрываем`),i=!1}else console.log(`NewsPage: Карточка ${o+1} - фильтр не активен, показываем`);i?(a.classList.remove("hidden"),n++):a.classList.add("hidden")}),console.log("NewsPage: Видимых карточек:",n),this.pagination&&this.pagination.updateVisibleItems()}bindNewsDetailsButtons(){const t=document.querySelectorAll(".news-details-btn");console.log("NewsPage: Найдено кнопок для новостей:",t.length),t.forEach(n=>{console.log("NewsPage: Добавление обработчика для кнопки"),n.addEventListener("click",a=>{var r,s,l,d,u;console.log('NewsPage: Клик по кнопке "Подробнее"'),a.preventDefault();const o=n.closest(".news-card");if(console.log("NewsPage: Найдена карточка новости:",o!==null),!o){console.error("NewsPage: Не удалось найти карточку новости");return}const i={title:(r=o.querySelector(".news-title"))==null?void 0:r.textContent,image:(s=o.querySelector("img"))==null?void 0:s.src,isPlaceholder:(l=o.querySelector("img"))==null?void 0:l.classList.contains("placeholder"),content:(d=o.querySelector(".news-content"))==null?void 0:d.textContent,date:(u=o.querySelector(".news-date"))==null?void 0:u.textContent};if(console.log("NewsPage: Собраны данные для модального окна:",i),!i.title||!i.content){console.error("NewsPage: Не удалось собрать все необходимые данные");return}this.openNewsModal(i)})})}openNewsModal(t){const n=this.modal,a=n.querySelector(".modal-content");a.querySelector("h2").textContent=t.title,a.querySelector(".news-text").textContent=t.content,a.querySelector(".text-caption-form").textContent=t.date;const o=a.querySelector(".news-image");t.image&&!t.isPlaceholder?o.innerHTML=`
        <div class="rounded-2xl overflow-hidden">
          <img src="${t.image}" 
               alt="${t.title}" 
               class="w-full object-cover aspect-[1.85/1]">
        </div>
      `:o.innerHTML="",I.open(n)}sortNewsByDate(){console.log("NewsPage: Сортировка новостей по дате...");const t=document.querySelector(".news-grid"),n=Array.from(document.querySelectorAll(".news-card"));if(!t||n.length===0){console.log("NewsPage: Нет новостей для сортировки");return}n.sort((a,o)=>{const i=parseInt(a.dataset.timestamp)||0;return(parseInt(o.dataset.timestamp)||0)-i}),n.forEach(a=>{t.appendChild(a)}),console.log("NewsPage: Новости отсортированы по дате (от новых к старым)")}}function so(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ne,q,fe=0;function pe(e){return e>=48&&e<=57}function ae(e,t){for(var n=(e+="").length,a=(t+="").length,o=0,i=0;o<n&&i<a;){var r=e.charCodeAt(o),s=t.charCodeAt(i);if(pe(r)){if(!pe(s))return r-s;for(var l=o,d=i;r===48&&++l<n;)r=e.charCodeAt(l);for(;s===48&&++d<a;)s=t.charCodeAt(d);for(var u=l,h=d;u<n&&pe(e.charCodeAt(u));)++u;for(;h<a&&pe(t.charCodeAt(h));)++h;var c=u-l-h+d;if(c)return c;for(;l<u;)if(c=e.charCodeAt(l++)-t.charCodeAt(d++),c)return c;o=u,i=h;continue}if(r!==s)return r<fe&&s<fe&&q[r]!==-1&&q[s]!==-1?q[r]-q[s]:r-s;++o,++i}return o>=n&&i<a&&n>=a?-1:i>=a&&o<n&&a>=n?1:n-a}ae.caseInsensitive=ae.i=function(e,t){return ae((""+e).toLowerCase(),(""+t).toLowerCase())},Object.defineProperties(ae,{alphabet:{get:function(){return ne},set:function(e){ne=e,q=[];var t=0;if(ne)for(;t<ne.length;t++)q[ne.charCodeAt(t)]=t;for(fe=q.length,t=0;t<fe;t++)q[t]===void 0&&(q[t]=-1)}}});var ro=ae,lo=function(e,t,n){return n?e.getElementsByClassName(t)[0]:e.getElementsByClassName(t)},co=function(e,t,n){return t="."+t,n?e.querySelector(t):e.querySelectorAll(t)},uo=function(e,t,n){for(var a=[],o="*",i=e.getElementsByTagName(o),r=i.length,s=new RegExp("(^|\\s)"+t+"(\\s|$)"),l=0,d=0;l<r;l++)if(s.test(i[l].className)){if(n)return i[l];a[d]=i[l],d++}return a},Yt=function(){return function(e,t,n,a){return a=a||{},a.test&&a.getElementsByClassName||!a.test&&document.getElementsByClassName?lo(e,t,n):a.test&&a.querySelector||!a.test&&document.querySelector?co(e,t,n):uo(e,t,n)}}(),_t=function(t){for(var n=Array.prototype.slice.call(arguments,1),a=0,o;o=n[a];a++)if(o)for(var i in o)t[i]=o[i];return t},ho=[].indexOf,zt=function(e,t){if(ho)return e.indexOf(t);for(var n=0,a=e.length;n<a;++n)if(e[n]===t)return n;return-1},G={},Wt=function(t){if(typeof t>"u")return[];if(t===null)return[null];if(t===window)return[window];if(typeof t=="string")return[t];if(mo(t))return t;if(typeof t.length!="number")return[t];if(typeof t=="function"&&t instanceof Function)return[t];for(var n=[],a=0,o=t.length;a<o;a++)(Object.prototype.hasOwnProperty.call(t,a)||a in t)&&n.push(t[a]);return n.length?n:[]};function mo(e){return Object.prototype.toString.call(e)==="[object Array]"}var Vt=window.addEventListener?"addEventListener":"attachEvent",go=window.removeEventListener?"removeEventListener":"detachEvent",Ut=Vt!=="addEventListener"?"on":"",Zt=Wt;G.bind=function(e,t,n,a){e=Zt(e);for(var o=0,i=e.length;o<i;o++)e[o][Vt](Ut+t,n,a||!1)},G.unbind=function(e,t,n,a){e=Zt(e);for(var o=0,i=e.length;o<i;o++)e[o][go](Ut+t,n,a||!1)},G.debounce=function(e,t,n){var a;return t?function(){var o=this,i=arguments,r=function(){a=null,n||e.apply(o,i)},s=n&&!a;clearTimeout(a),a=setTimeout(r,t),s&&e.apply(o,i)}:e};var Gt=function(e){return e=e===void 0?"":e,e=e===null?"":e,e=e.toString(),e},Fe=zt,fo=/\s+/,jt=function(e){return new W(e)};function W(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}W.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=Fe(t,e);return~n||t.push(e),this.el.className=t.join(" "),this},W.prototype.remove=function(e){if(this.list)return this.list.remove(e),this;var t=this.array(),n=Fe(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},W.prototype.toggle=function(e,t){return this.list?(typeof t<"u"?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(typeof t<"u"?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},W.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(fo);return n[0]===""&&n.shift(),n},W.prototype.has=W.prototype.contains=function(e){return this.list?this.list.contains(e):!!~Fe(this.array(),e)};var po=function(e,t){var n=e.getAttribute&&e.getAttribute(t)||null;if(!n)for(var a=e.attributes,o=a.length,i=0;i<o;i++)a[i]!==void 0&&a[i].nodeName===t&&(n=a[i].nodeValue);return n},Oe,Kt;function Jt(){return Kt||(Kt=1,Oe=function(e){return function(t,n,a){var o=this;this._values={},this.found=!1,this.filtered=!1;var i=function(r,s,l){if(s===void 0)l?o.values(r,l):o.values(r);else{o.elm=s;var d=e.templater.get(o,r);o.values(d)}};this.values=function(r,s){if(r!==void 0){for(var l in r)o._values[l]=r[l];s!==!0&&e.templater.set(o,o.values())}else return o._values},this.show=function(){e.templater.show(o)},this.hide=function(){e.templater.hide(o)},this.matching=function(){return e.filtered&&e.searched&&o.found&&o.filtered||e.filtered&&!e.searched&&o.filtered||!e.filtered&&e.searched&&o.found||!e.filtered&&!e.searched},this.visible=function(){return!!(o.elm&&o.elm.parentNode==e.list)},i(t,n,a)}}),Oe}var Re,Xt;function vo(){return Xt||(Xt=1,Re=function(e){var t=function(n,a,o){var i=n.splice(0,50);o=o||[],o=o.concat(e.add(i)),n.length>0?setTimeout(function(){t(n,a,o)},1):(e.update(),a(o))};return t}),Re}var He,Qt;function yo(){if(Qt)return He;Qt=1;var e=jt,t=G,n=cn();return He=function(a){var o=!1,i=function(s,l){if(a.page<1){a.listContainer.style.display="none",o=!0;return}else o&&(a.listContainer.style.display="block");var d,u=a.matchingItems.length,h=a.i,c=a.page,m=Math.ceil(u/c),f=Math.ceil(h/c),y=l.innerWindow||2,E=l.left||l.outerWindow||0,g=l.right||l.outerWindow||0;g=m-g,s.clear();for(var p=1;p<=m;p++){var w=f===p?"active":"";r.number(p,E,g,f,y)?(d=s.add({page:p,dotted:!1})[0],w&&e(d.elm).add(w),d.elm.firstChild.setAttribute("data-i",p),d.elm.firstChild.setAttribute("data-page",c)):r.dotted(s,p,E,g,f,y,s.size())&&(d=s.add({page:"...",dotted:!0})[0],e(d.elm).add("disabled"))}},r={number:function(s,l,d,u,h){return this.left(s,l)||this.right(s,d)||this.innerWindow(s,u,h)},left:function(s,l){return s<=l},right:function(s,l){return s>l},innerWindow:function(s,l,d){return s>=l-d&&s<=l+d},dotted:function(s,l,d,u,h,c,m){return this.dottedLeft(s,l,d,u,h,c)||this.dottedRight(s,l,d,u,h,c,m)},dottedLeft:function(s,l,d,u,h,c){return l==d+1&&!this.innerWindow(l,h,c)&&!this.right(l,u)},dottedRight:function(s,l,d,u,h,c,m){return s.items[m-1].values().dotted?!1:l==u&&!this.innerWindow(l,h,c)&&!this.right(l,u)}};return function(s){var l=new n(a.listContainer.id,{listClass:s.paginationClass||"pagination",item:s.item||"<li><a class='page' href='#'></a></li>",valueNames:["page","dotted"],searchClass:"pagination-search-that-is-not-supposed-to-exist",sortClass:"pagination-sort-that-is-not-supposed-to-exist"});t.bind(l.listContainer,"click",function(d){var u=d.target||d.srcElement,h=a.utils.getAttribute(u,"data-page"),c=a.utils.getAttribute(u,"data-i");c&&a.show((c-1)*h+1,h)}),a.on("updated",function(){i(l,s)}),i(l,s)}},He}var Ye,en;function bo(){return en||(en=1,Ye=function(e){var t=Jt()(e),n=function(i){for(var r=i.childNodes,s=[],l=0,d=r.length;l<d;l++)r[l].data===void 0&&s.push(r[l]);return s},a=function(i,r){for(var s=0,l=i.length;s<l;s++)e.items.push(new t(r,i[s]))},o=function(i,r){var s=i.splice(0,50);a(s,r),i.length>0?setTimeout(function(){o(i,r)},1):(e.update(),e.trigger("parseComplete"))};return e.handlers.parseComplete=e.handlers.parseComplete||[],function(){var i=n(e.list),r=e.valueNames;e.indexAsync?o(i,r):a(i,r)}}),Ye}var _e,tn;function wo(){if(tn)return _e;tn=1;var e=function(t){var n,a=this,o=function(){var u;if(typeof t.item=="function"){n=function(h){var c=t.item(h);return s(c)};return}if(typeof t.item=="string"?t.item.indexOf("<")===-1?u=document.getElementById(t.item):u=s(t.item):u=r(),!u)throw new Error("The list needs to have at least one item on init otherwise you'll have to add a template.");u=i(u,t.valueNames),n=function(){return u.cloneNode(!0)}},i=function(u,h){var c=u.cloneNode(!0);c.removeAttribute("id");for(var m=0,f=h.length;m<f;m++){var y=void 0,E=h[m];if(E.data)for(var g=0,p=E.data.length;g<p;g++)c.setAttribute("data-"+E.data[g],"");else E.attr&&E.name?(y=t.utils.getByClass(c,E.name,!0),y&&y.setAttribute(E.attr,"")):(y=t.utils.getByClass(c,E,!0),y&&(y.innerHTML=""))}return c},r=function(){for(var u=t.list.childNodes,h=0,c=u.length;h<c;h++)if(u[h].data===void 0)return u[h].cloneNode(!0)},s=function(u){if(typeof u=="string"){if(/<tr[\s>]/g.exec(u)){var h=document.createElement("tbody");return h.innerHTML=u,h.firstElementChild}else if(u.indexOf("<")!==-1){var c=document.createElement("div");return c.innerHTML=u,c.firstElementChild}}},l=function(u){for(var h=0,c=t.valueNames.length;h<c;h++){var m=t.valueNames[h];if(m.data){for(var f=m.data,y=0,E=f.length;y<E;y++)if(f[y]===u)return{data:u}}else{if(m.attr&&m.name&&m.name==u)return m;if(m===u)return u}}},d=function(u,h,c){var m=void 0,f=l(h);f&&(f.data?u.elm.setAttribute("data-"+f.data,c):f.attr&&f.name?(m=t.utils.getByClass(u.elm,f.name,!0),m&&m.setAttribute(f.attr,c)):(m=t.utils.getByClass(u.elm,f,!0),m&&(m.innerHTML=c)))};this.get=function(u,h){a.create(u);for(var c={},m=0,f=h.length;m<f;m++){var y=void 0,E=h[m];if(E.data)for(var g=0,p=E.data.length;g<p;g++)c[E.data[g]]=t.utils.getAttribute(u.elm,"data-"+E.data[g]);else E.attr&&E.name?(y=t.utils.getByClass(u.elm,E.name,!0),c[E.name]=y?t.utils.getAttribute(y,E.attr):""):(y=t.utils.getByClass(u.elm,E,!0),c[E]=y?y.innerHTML:"")}return c},this.set=function(u,h){if(!a.create(u))for(var c in h)h.hasOwnProperty(c)&&d(u,c,h[c])},this.create=function(u){return u.elm!==void 0?!1:(u.elm=n(u.values()),a.set(u,u.values()),!0)},this.remove=function(u){u.elm.parentNode===t.list&&t.list.removeChild(u.elm)},this.show=function(u){a.create(u),t.list.appendChild(u.elm)},this.hide=function(u){u.elm!==void 0&&u.elm.parentNode===t.list&&t.list.removeChild(u.elm)},this.clear=function(){if(t.list.hasChildNodes())for(;t.list.childNodes.length>=1;)t.list.removeChild(t.list.firstChild)},o()};return _e=function(t){return new e(t)},_e}var ze,nn;function xo(){return nn||(nn=1,ze=function(e){var t,n,a,o={resetList:function(){e.i=1,e.templater.clear(),a=void 0},setOptions:function(s){s.length==2&&s[1]instanceof Array?t=s[1]:s.length==2&&typeof s[1]=="function"?(t=void 0,a=s[1]):s.length==3?(t=s[1],a=s[2]):t=void 0},setColumns:function(){e.items.length!==0&&t===void 0&&(t=e.searchColumns===void 0?o.toArray(e.items[0].values()):e.searchColumns)},setSearchString:function(s){s=e.utils.toString(s).toLowerCase(),s=s.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),n=s},toArray:function(s){var l=[];for(var d in s)l.push(d);return l}},i={list:function(){for(var s=[],l,d=n;(l=d.match(/"([^"]+)"/))!==null;)s.push(l[1]),d=d.substring(0,l.index)+d.substring(l.index+l[0].length);d=d.trim(),d.length&&(s=s.concat(d.split(/\s+/)));for(var u=0,h=e.items.length;u<h;u++){var c=e.items[u];if(c.found=!1,!!s.length){for(var m=0,f=s.length;m<f;m++){for(var y=!1,E=0,g=t.length;E<g;E++){var p=c.values(),w=t[E];if(p.hasOwnProperty(w)&&p[w]!==void 0&&p[w]!==null){var D=typeof p[w]!="string"?p[w].toString():p[w];if(D.toLowerCase().indexOf(s[m])!==-1){y=!0;break}}}if(!y)break}c.found=y}}},reset:function(){e.reset.search(),e.searched=!1}},r=function(s){return e.trigger("searchStart"),o.resetList(),o.setSearchString(s),o.setOptions(arguments),o.setColumns(),n===""?i.reset():(e.searched=!0,a?a(n,t):i.list()),e.update(),e.trigger("searchComplete"),e.visibleItems};return e.handlers.searchStart=e.handlers.searchStart||[],e.handlers.searchComplete=e.handlers.searchComplete||[],e.utils.events.bind(e.utils.getByClass(e.listContainer,e.searchClass),"keyup",e.utils.events.debounce(function(s){var l=s.target||s.srcElement,d=l.value===""&&!e.searched;d||r(l.value)},e.searchDelay)),e.utils.events.bind(e.utils.getByClass(e.listContainer,e.searchClass),"input",function(s){var l=s.target||s.srcElement;l.value===""&&r("")}),r}),ze}var We,an;function Eo(){return an||(an=1,We=function(e){return e.handlers.filterStart=e.handlers.filterStart||[],e.handlers.filterComplete=e.handlers.filterComplete||[],function(t){if(e.trigger("filterStart"),e.i=1,e.reset.filter(),t===void 0)e.filtered=!1;else{e.filtered=!0;for(var n=e.items,a=0,o=n.length;a<o;a++){var i=n[a];t(i)?i.filtered=!0:i.filtered=!1}}return e.update(),e.trigger("filterComplete"),e.visibleItems}}),We}var Ve,on;function Do(){return on||(on=1,Ve=function(e){var t={els:void 0,clear:function(){for(var a=0,o=t.els.length;a<o;a++)e.utils.classes(t.els[a]).remove("asc"),e.utils.classes(t.els[a]).remove("desc")},getOrder:function(a){var o=e.utils.getAttribute(a,"data-order");return o=="asc"||o=="desc"?o:e.utils.classes(a).has("desc")?"asc":e.utils.classes(a).has("asc")?"desc":"asc"},getInSensitive:function(a,o){var i=e.utils.getAttribute(a,"data-insensitive");i==="false"?o.insensitive=!1:o.insensitive=!0},setOrder:function(a){for(var o=0,i=t.els.length;o<i;o++){var r=t.els[o];if(e.utils.getAttribute(r,"data-sort")===a.valueName){var s=e.utils.getAttribute(r,"data-order");s=="asc"||s=="desc"?s==a.order&&e.utils.classes(r).add(a.order):e.utils.classes(r).add(a.order)}}}},n=function(){e.trigger("sortStart");var a={},o=arguments[0].currentTarget||arguments[0].srcElement||void 0;o?(a.valueName=e.utils.getAttribute(o,"data-sort"),t.getInSensitive(o,a),a.order=t.getOrder(o)):(a=arguments[1]||a,a.valueName=arguments[0],a.order=a.order||"asc",a.insensitive=typeof a.insensitive>"u"?!0:a.insensitive),t.clear(),t.setOrder(a);var i=a.sortFunction||e.sortFunction||null,r=a.order==="desc"?-1:1,s;i?s=function(l,d){return i(l,d,a)*r}:s=function(l,d){var u=e.utils.naturalSort;return u.alphabet=e.alphabet||a.alphabet||void 0,!u.alphabet&&a.insensitive&&(u=e.utils.naturalSort.caseInsensitive),u(l.values()[a.valueName],d.values()[a.valueName])*r},e.items.sort(s),e.update(),e.trigger("sortComplete")};return e.handlers.sortStart=e.handlers.sortStart||[],e.handlers.sortComplete=e.handlers.sortComplete||[],t.els=e.utils.getByClass(e.listContainer,e.sortClass),e.utils.events.bind(t.els,"click",n),e.on("searchStart",t.clear),e.on("filterStart",t.clear),n}),Ve}var Ue,sn;function Mo(){return sn||(sn=1,Ue=function(e,t,n){var a=n.location||0,o=n.distance||100,i=n.threshold||.4;if(t===e)return!0;if(t.length>32)return!1;var r=a,s=function(){var k={},P;for(P=0;P<t.length;P++)k[t.charAt(P)]=0;for(P=0;P<t.length;P++)k[t.charAt(P)]|=1<<t.length-P-1;return k}();function l(k,P){var $=k/t.length,F=Math.abs(r-P);return o?$+F/o:F?1:$}var d=i,u=e.indexOf(t,r);u!=-1&&(d=Math.min(l(0,u),d),u=e.lastIndexOf(t,r+t.length),u!=-1&&(d=Math.min(l(0,u),d)));var h=1<<t.length-1;u=-1;for(var c,m,f=t.length+e.length,y,E=0;E<t.length;E++){for(c=0,m=f;c<m;)l(E,r+m)<=d?c=m:f=m,m=Math.floor((f-c)/2+c);f=m;var g=Math.max(1,r-m+1),p=Math.min(r+m,e.length)+t.length,w=Array(p+2);w[p+1]=(1<<E)-1;for(var D=p;D>=g;D--){var S=s[e.charAt(D-1)];if(E===0?w[D]=(w[D+1]<<1|1)&S:w[D]=(w[D+1]<<1|1)&S|((y[D+1]|y[D])<<1|1)|y[D+1],w[D]&h){var C=l(E,D-1);if(C<=d)if(d=C,u=D-1,u>r)g=Math.max(1,2*r-u);else break}}if(l(E+1,r)>d)break;y=w}return!(u<0)}),Ue}var Ze,rn;function Co(){if(rn)return Ze;rn=1;var e=G,t=_t,n=Gt,a=Yt,o=Mo();return Ze=function(i,r){r=r||{},r=t({location:0,distance:100,threshold:.4,multiSearch:!0,searchClass:"fuzzy-search"},r);var s={search:function(l,d){for(var u=r.multiSearch?l.replace(/ +$/,"").split(/ +/):[l],h=0,c=i.items.length;h<c;h++)s.item(i.items[h],d,u)},item:function(l,d,u){for(var h=!0,c=0;c<u.length;c++){for(var m=!1,f=0,y=d.length;f<y;f++)s.values(l.values(),d[f],u[c])&&(m=!0);m||(h=!1)}l.found=h},values:function(l,d,u){if(l.hasOwnProperty(d)){var h=n(l[d]).toLowerCase();if(o(h,u,r))return!0}return!1}};return e.bind(a(i.listContainer,r.searchClass),"keyup",i.utils.events.debounce(function(l){var d=l.target||l.srcElement;i.search(d.value,s.search)},i.searchDelay)),function(l,d){i.search(l,d,s.search)}},Ze}var Ge,ln;function cn(){if(ln)return Ge;ln=1;var e=ro,t=Yt,n=_t,a=zt,o=G,i=Gt,r=jt,s=po,l=Wt;return Ge=function(d,u,h){var c=this,m,f=Jt()(c),y=vo()(c),E=yo()(c);m={start:function(){c.listClass="list",c.searchClass="search",c.sortClass="sort",c.page=1e4,c.i=1,c.items=[],c.visibleItems=[],c.matchingItems=[],c.searched=!1,c.filtered=!1,c.searchColumns=void 0,c.searchDelay=0,c.handlers={updated:[]},c.valueNames=[],c.utils={getByClass:t,extend:n,indexOf:a,events:o,toString:i,naturalSort:e,classes:r,getAttribute:s,toArray:l},c.utils.extend(c,u),c.listContainer=typeof d=="string"?document.getElementById(d):d,c.listContainer&&(c.list=t(c.listContainer,c.listClass,!0),c.parse=bo()(c),c.templater=wo()(c),c.search=xo()(c),c.filter=Eo()(c),c.sort=Do()(c),c.fuzzySearch=Co()(c,u.fuzzySearch),this.handlers(),this.items(),this.pagination(),c.update())},handlers:function(){for(var g in c.handlers)c[g]&&c.handlers.hasOwnProperty(g)&&c.on(g,c[g])},items:function(){c.parse(c.list),h!==void 0&&c.add(h)},pagination:function(){if(u.pagination!==void 0){u.pagination===!0&&(u.pagination=[{}]),u.pagination[0]===void 0&&(u.pagination=[u.pagination]);for(var g=0,p=u.pagination.length;g<p;g++)E(u.pagination[g])}}},this.reIndex=function(){c.items=[],c.visibleItems=[],c.matchingItems=[],c.searched=!1,c.filtered=!1,c.parse(c.list)},this.toJSON=function(){for(var g=[],p=0,w=c.items.length;p<w;p++)g.push(c.items[p].values());return g},this.add=function(g,p){if(g.length!==0){if(p){y(g.slice(0),p);return}var w=[],D=!1;g[0]===void 0&&(g=[g]);for(var S=0,C=g.length;S<C;S++){var k=null;D=c.items.length>c.page,k=new f(g[S],void 0,D),c.items.push(k),w.push(k)}return c.update(),w}},this.show=function(g,p){return this.i=g,this.page=p,c.update(),c},this.remove=function(g,p,w){for(var D=0,S=0,C=c.items.length;S<C;S++)c.items[S].values()[g]==p&&(c.templater.remove(c.items[S],w),c.items.splice(S,1),C--,S--,D++);return c.update(),D},this.get=function(g,p){for(var w=[],D=0,S=c.items.length;D<S;D++){var C=c.items[D];C.values()[g]==p&&w.push(C)}return w},this.size=function(){return c.items.length},this.clear=function(){return c.templater.clear(),c.items=[],c},this.on=function(g,p){return c.handlers[g].push(p),c},this.off=function(g,p){var w=c.handlers[g],D=a(w,p);return D>-1&&w.splice(D,1),c},this.trigger=function(g){for(var p=c.handlers[g].length;p--;)c.handlers[g][p](c);return c},this.reset={filter:function(){for(var g=c.items,p=g.length;p--;)g[p].filtered=!1;return c},search:function(){for(var g=c.items,p=g.length;p--;)g[p].found=!1;return c}},this.update=function(){var g=c.items,p=g.length;c.visibleItems=[],c.matchingItems=[],c.templater.clear();for(var w=0;w<p;w++)g[w].matching()&&c.matchingItems.length+1>=c.i&&c.visibleItems.length<c.page?(g[w].show(),c.visibleItems.push(g[w]),c.matchingItems.push(g[w])):(g[w].matching()&&c.matchingItems.push(g[w]),g[w].hide());return c.trigger("updated"),c},m.start()},Ge}var So=cn();const ko=so(So);class dn{constructor(t={}){this.config={containerId:t.containerId||"table-container",valueNames:t.valueNames||[],listClass:"listjs-container",page:t.page||10,searchEnabled:t.searchEnabled||!1,searchInputId:t.searchInputId||null,sortEnabled:t.sortEnabled!==!1,paginationEnabled:t.paginationEnabled!==!1,itemsCountEnabled:t.itemsCountEnabled!==!1,...t},this.list=null,this.searchInput=null,this.init()}init(){if(console.log(`Инициализация TableManager для контейнера: ${this.config.containerId}`),!document.getElementById(this.config.containerId)){console.log(`Контейнер ${this.config.containerId} не найден, пропускаем инициализацию`);return}this.initTable(),this.config.searchEnabled&&this.initSearch(),this.config.sortEnabled&&this.initSorting(),this.config.paginationEnabled&&this.initPaginationArrows(),this.config.itemsCountEnabled&&this.updateItemsCount()}initTable(){this.ensureTableHasData();const t={valueNames:this.config.valueNames,listClass:this.config.listClass,page:this.config.page};this.config.searchEnabled&&this.config.searchInputId&&(t.searchClass="search"),this.config.paginationEnabled&&(t.pagination={innerWindow:1,outerWindow:1,left:1,right:1,item:'<li><a class="page join-item btn btn-sm"></a></li>',paginationClass:"pagination join"}),this.list=new ko(this.config.containerId,t),this.config.paginationEnabled&&setTimeout(()=>{this.togglePaginationVisibility()},50),this.list.on("updated",()=>{this.config.itemsCountEnabled&&this.updateItemsCount(),this.config.paginationEnabled&&(this.togglePaginationVisibility(),setTimeout(()=>{this.updatePaginationArrows(),this.setupStandardPaginationArrows()},10))}),this.config.paginationEnabled&&setTimeout(()=>this.setupStandardPaginationArrows(),100)}ensureTableHasData(){const t=document.querySelector(`#${this.config.containerId} tbody.${this.config.listClass}`);if(t&&t.children.length===0){console.log("Нет данных в таблице, добавляем пустой элемент для инициализации");const a=document.querySelectorAll(`#${this.config.containerId} thead th`).length;let o="";for(let i=0;i<a;i++)o+='<td class="px-4 py-3 text-brand-gray">-</td>';t.innerHTML=`
        <tr class="hidden" data-type="template" data-id="0">
          ${o}
        </tr>
      `}}initSearch(){if(!this.config.searchInputId)return;if(this.searchInput=document.getElementById(this.config.searchInputId),!this.searchInput){console.log(`Поле поиска ${this.config.searchInputId} не найдено`);return}this.searchInput.classList.add("w-full","bg-brand-light","rounded-xl","p-3");let t;this.searchInput.addEventListener("input",n=>{clearTimeout(t),t=setTimeout(()=>{const a=n.target.value.toLowerCase().trim();a===""?this.list.search():this.list.search(a)},300)}),this.searchInput.addEventListener("keydown",n=>{n.key==="Escape"&&(this.searchInput.value="",this.list.search())})}initSorting(){document.querySelectorAll(`#${this.config.containerId} .sort[data-sort]`).forEach(n=>{n.addEventListener("click",()=>{setTimeout(()=>{this.updateSortIndicators()},10)})})}updateSortIndicators(){document.querySelectorAll(`#${this.config.containerId} .sort[data-sort]`).forEach(n=>{const a=n.querySelector("svg");a&&(n.classList.contains("asc")?a.style.transform="rotate(0deg)":n.classList.contains("desc")?a.style.transform="rotate(180deg)":a.style.transform="rotate(0deg)")})}initPaginationArrows(){const t=document.getElementById("prev-page"),n=document.getElementById("next-page");t&&t.addEventListener("click",()=>{const a=this.getCurrentPage();a>1&&this.list.show((a-2)*this.list.page+1,this.list.page)}),n&&n.addEventListener("click",()=>{const a=this.getCurrentPage(),o=Math.ceil(this.list.size()/this.list.page);a<o&&this.list.show(a*this.list.page+1,this.list.page)}),setTimeout(()=>this.updatePaginationArrows(),100)}updatePaginationArrows(){const t=document.querySelector(`#${this.config.containerId} .pagination`);if(!t)return;const n=t.querySelector(".pagination-prev"),a=t.querySelector(".pagination-next");if(!n||!a)return;const o=this.getCurrentPage(),i=Math.ceil(this.list.size()/this.list.page);o<=1?(n.disabled=!0,n.classList.add("opacity-50","cursor-not-allowed")):(n.disabled=!1,n.classList.remove("opacity-50","cursor-not-allowed")),o>=i?(a.disabled=!0,a.classList.add("opacity-50","cursor-not-allowed")):(a.disabled=!1,a.classList.remove("opacity-50","cursor-not-allowed")),this.updateNavigationArrows()}getCurrentPage(){const t=document.querySelector(`#${this.config.containerId} .pagination .active .page`);if(t)return parseInt(t.textContent)||1;const n=document.querySelector(`#${this.config.containerId} .pagination .active`);if(n){const a=n.textContent||n.innerText,o=parseInt(a);if(!isNaN(o))return o}return 1}updateItemsCount(){const t=document.getElementById("items-count"),n=document.getElementById("total-count");t&&n&&this.list&&(t.textContent=this.list.visibleItems.length,n.textContent=this.list.items.length)}filter(t){this.list&&this.list.filter(t)}clearFilter(){this.list&&this.list.filter()}addItem(t){this.list&&this.list.add(t)}removeItem(t){this.list&&this.list.remove("id",t)}getList(){return this.list}search(t=""){this.list&&this.list.search(t)}clearSearch(){this.searchInput&&(this.searchInput.value=""),this.search("")}setupStandardPaginationArrows(){const t=document.querySelector(`#${this.config.containerId} .pagination`);if(!t)return;const n=t.querySelectorAll(".page");if(n.length===0)return;const a=n[0],o=n[n.length-1];a&&isNaN(parseInt(a.textContent))&&(a.innerHTML="‹",a.classList.add("pagination-arrow","pagination-prev")),o&&isNaN(parseInt(o.textContent))&&(o.innerHTML="›",o.classList.add("pagination-arrow","pagination-next")),this.addNavigationArrows(t,a,o)}addNavigationArrows(t,n,a){if(t.querySelector(".pagination-first")||t.querySelector(".pagination-last"))return;const o=document.createElement("li");o.innerHTML='<a class="page join-item btn btn-sm pagination-first pagination-arrow">«</a>';const i=document.createElement("li");i.innerHTML='<a class="page join-item btn btn-sm pagination-last pagination-arrow">»</a>',n&&n.parentElement&&t.insertBefore(o,n.parentElement),a&&a.parentElement&&t.insertBefore(i,a.parentElement.nextSibling);const r=o.querySelector(".pagination-first"),s=i.querySelector(".pagination-last");r&&r.addEventListener("click",l=>{l.preventDefault(),this.list.show(1,this.list.page)}),s&&s.addEventListener("click",l=>{l.preventDefault();const d=Math.ceil(this.list.size()/this.list.page);this.list.show((d-1)*this.list.page+1,this.list.page)}),this.updateNavigationArrows()}updateNavigationArrows(){const t=document.querySelector(`#${this.config.containerId} .pagination`);if(!t)return;const n=t.querySelector(".pagination-first"),a=t.querySelector(".pagination-last"),o=t.querySelector(".pagination-prev"),i=t.querySelector(".pagination-next");if(!n||!a)return;const r=this.getCurrentPage(),s=Math.ceil(this.list.size()/this.list.page);r<=1?(n.disabled=!0,n.classList.add("opacity-50","cursor-not-allowed")):(n.disabled=!1,n.classList.remove("opacity-50","cursor-not-allowed")),r>=s?(a.disabled=!0,a.classList.add("opacity-50","cursor-not-allowed")):(a.disabled=!1,a.classList.remove("opacity-50","cursor-not-allowed")),o&&(r<=1?(o.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed")):(o.disabled=!1,o.classList.remove("opacity-50","cursor-not-allowed"))),i&&(r>=s?(i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed")):(i.disabled=!1,i.classList.remove("opacity-50","cursor-not-allowed")))}togglePaginationVisibility(){const t=document.querySelector(`#${this.config.containerId} .pagination`);if(!t){console.log("Контейнер пагинации не найден");return}setTimeout(()=>{const n=t.querySelectorAll(".page"),a=Array.from(n).filter(o=>{const i=o.textContent.trim();return!isNaN(parseInt(i))&&i!==""});console.log(`Проверка пагинации: найдено ${a.length} кнопок с номерами страниц`),a.length<=1?(t.style.display="none",console.log("Пагинация скрыта: одна страница или меньше")):(t.style.display="flex",console.log(`Пагинация показана: ${a.length} страниц`))},20)}}class Io{constructor(){this.tableManager=null,this.emailModal=null,this.periodPicker=null,this.init()}init(){if(console.log("Инициализация страницы актов оказания услуг"),!document.getElementById("acts-table")){console.log("Таблица актов не найдена, пропускаем инициализацию");return}this.initTable(),this.initModal(),this.initRequestForm(),this.initDateFilters()}initTable(){this.tableManager=new dn({containerId:"acts-table",valueNames:["date","actNumber","amount","organizationName"],page:10,searchEnabled:!0,searchInputId:"search-input",customPagination:!1})}initDateFilters(){const t=document.getElementById("period-picker-container");if(!t)return;t.innerHTML="";const n=new Date;new Date(n.getFullYear(),n.getMonth(),1);const a=o=>o.toISOString().split("T")[0];this.periodPicker=new qe({selector:"#period-picker-container",placeholder:"Выберите период для акта сверки",autoApply:!0,minDate:a(new Date(n.getFullYear()-1,0,1)),maxDate:a(n),onRangeSelect:o=>{console.log("Выбран период для акта сверки:",o)}})}updateItemCounts(){if(!this.tableManager||!this.tableManager.list)return;const t=this.tableManager.list.visibleItems.length,n=this.tableManager.list.items.length,a=document.getElementById("items-count"),o=document.getElementById("total-count");a&&(a.textContent=t),o&&(o.textContent=n)}initModal(){if(this.emailModal=document.getElementById("email_modal"),!this.emailModal)return;const t=document.getElementById("modal-act-number"),n=document.getElementById("email-form");document.addEventListener("click",a=>{const o=a.target.closest(".send-email-btn");if(o){const i=o.dataset.actNumber;o.dataset.organization,t.textContent=i,I.open(this.emailModal)}}),n.addEventListener("submit",a=>{a.preventDefault();const o=document.getElementById("modal-email").value,i=t.textContent;console.log("Отправка акта",i,"на email:",o),alert("Акт успешно отправлен на "+o),I.close(this.emailModal),n.reset()})}initRequestForm(){const t=document.getElementById("request-form");t&&t.addEventListener("submit",n=>{n.preventDefault();const a=document.getElementById("email-input").value,o=this.periodPicker?this.periodPicker.getValue():null;if(!o||o.isEmpty){alert("Пожалуйста, выберите период для акта сверки");return}console.log("Запрос акта сверки на email:",a,"за период:",o),alert(`Запрос на акт сверки за период ${o.formattedRange} отправлен на ${a}`),t.reset(),this.periodPicker&&this.periodPicker.clearSelection()})}}function un(){new Io}class Lo{constructor(){this.tableManager=null,this.editModal=null,this.deleteModal=null,this.createModal=null,this.currentType="all",this.init()}init(){if(console.log("Инициализация страницы отправителей и получателей"),!document.getElementById("contacts-table")){console.log("Таблица отправителей/получателей не найдена, пропускаем инициализацию");return}this.initTable(),this.initModals(),this.initCreateButton(),this.initTypeTabs()}initTypeTabs(){const t=document.querySelectorAll(".type-tab");t.forEach(n=>{n.addEventListener("click",()=>{t.forEach(a=>{a.dataset.active="false"}),n.dataset.active="true",this.currentType=n.dataset.type,this.filterTable()})})}filterTable(){if(!this.tableManager||!this.tableManager.list)return;const t=this.tableManager.list;t.filter(),this.currentType!=="all"&&t.filter(n=>n.values().type===this.currentType),this.updateCounters()}updateCounters(){if(!this.tableManager||!this.tableManager.list)return;const t=this.tableManager.list,n=t.visibleItems.length,a=t.items.length;document.getElementById("items-count").textContent=n,document.getElementById("total-count").textContent=a}initTable(){this.tableManager=new dn({containerId:"contacts-table",valueNames:["type","name","phone","location","address"],page:10,searchEnabled:!0,searchInputId:"search-input"});const t=document.getElementById("search-input");t&&t.addEventListener("input",()=>{this.updateCounters()}),this.updateCounters()}initModals(){this.initEditModal(),this.initDeleteModal(),this.initCreateModal()}initEditModal(){if(this.editModal=document.getElementById("edit-modal"),!this.editModal)return;const t=document.getElementById("edit-form");document.addEventListener("click",n=>{if(n.target.closest(".edit-btn")){const a=n.target.closest(".edit-btn"),o=a.dataset.id,i=a.closest("tr");document.getElementById("edit-type").value=i.dataset.type,document.getElementById("edit-name").value=i.querySelector(".name").textContent,document.getElementById("edit-phone").value=i.querySelector(".phone").textContent,document.getElementById("edit-location").value=i.querySelector(".location").textContent,document.getElementById("edit-address").value=i.querySelector(".address").textContent,document.getElementById("edit-id").value=o,I.open(this.editModal)}}),t.addEventListener("submit",n=>{n.preventDefault();const a=document.getElementById("edit-id").value,o=document.getElementById("edit-type").value,i=document.getElementById("edit-name").value,r=document.getElementById("edit-phone").value,s=document.getElementById("edit-location").value,l=document.getElementById("edit-address").value;console.log("Редактирование контакта",a,o,i,r,s,l),alert("Контакт успешно отредактирован"),I.close(this.editModal),t.reset()})}initDeleteModal(){if(this.deleteModal=document.getElementById("delete-modal"),!this.deleteModal)return;const t=document.getElementById("delete-form"),n=document.getElementById("modal-contact-name");document.addEventListener("click",a=>{if(a.target.closest(".delete-btn")){const o=a.target.closest(".delete-btn"),i=o.dataset.id,s=o.closest("tr").querySelector(".name").textContent;document.getElementById("delete-id").value=i,n.textContent=s,I.open(this.deleteModal)}}),t.addEventListener("submit",a=>{a.preventDefault();const o=document.getElementById("delete-id").value;console.log("Удаление контакта",o),alert("Контакт успешно удален"),I.close(this.deleteModal),t.reset()})}initCreateModal(){if(this.createModal=document.getElementById("create-modal"),!this.createModal)return;const t=document.getElementById("create-form");t.addEventListener("submit",n=>{n.preventDefault();const a=document.getElementById("create-type").value,o=document.getElementById("create-name").value,i=document.getElementById("create-phone").value,r=document.getElementById("create-location").value,s=document.getElementById("create-address").value,l=document.getElementById("create-comment").value;console.log("Создание нового контакта",a,o,i,r,s,l),alert("Контакт успешно создан"),I.close(this.createModal),t.reset()})}initCreateButton(){const t=document.getElementById("create-btn");t&&t.addEventListener("click",()=>{I.open(this.createModal)})}}function hn(){new Lo}const mn=document.getElementById("change-password-btn");mn&&mn.addEventListener("click",e=>{e.preventDefault(),I.create({id:"change-password-modal",title:"Изменить пароль",content:`
        <form class='space-y-4' id='change-password-form'>
          <input type='password' name='current' placeholder='Текущий пароль' class='px-4 py-3 rounded-lg border border-gray-200 w-full focus:outline-none focus:border-brand-blue text-body-secondary' required />
          <input type='password' name='new' placeholder='Новый пароль' class='px-4 py-3 rounded-lg border border-gray-200 w-full focus:outline-none focus:border-brand-blue text-body-secondary' required />
          <input type='password' name='repeat' placeholder='Повторите новый пароль' class='px-4 py-3 rounded-lg border border-gray-200 w-full focus:outline-none focus:border-brand-blue text-body-secondary' required />
          <button type='submit' class='bg-brand-blue text-white px-6 py-3 rounded-lg text-buttons w-full'>Изменить</button>
        </form>
      `,size:"small",onOpen:t=>{const n=t.querySelector("#change-password-form");n&&n.addEventListener("submit",a=>{a.preventDefault(),console.log("Смена пароля"),I.close(t)})}})});const gn=document.getElementById("edit-email-btn");gn&&gn.addEventListener("click",e=>{e.preventDefault(),I.create({id:"change-email-modal",title:"Изменить почту для восстановления",content:`
        <form class='space-y-4' id='change-email-form'>
          <input type='email' name='email' placeholder='Новая почта' class='px-4 py-3 rounded-lg border border-gray-200 w-full focus:outline-none focus:border-brand-blue text-body-secondary' required />
          <button type='submit' class='bg-brand-blue text-white px-6 py-3 rounded-lg text-buttons w-full'>Сохранить</button>
        </form>
      `,size:"small",onOpen:t=>{const n=t.querySelector("#change-email-form");n&&n.addEventListener("submit",a=>{a.preventDefault(),console.log("Смена email"),I.close(t)})}})});const Ao="";console.log("main.js: Начало загрузки");const fn=Je();console.log("Определен базовый путь:",fn),window.BASE_PATH=fn,window.modalManager=I,window.DateRangePicker=qe,window.initMap=te,window.selectOfficeCard=me,window.selectOfficeCardNoFocus=L,window.updateInfoPanel=Be,window.getZoomForDevice=Z,window.getCenterForDevice=kt,window.getMarkerSizeForZoom=_,window.createColoredMarkerIcon=Y,window.mapConfig=T,window.loadSwiper=Lt,window.initSwiperSlider=It,window.initMobileMenu=Pt,window.initTitleAnimations=At,window.initForms=qt,window.initFaqAccordion=Tt,window.initPaymentTabs=$t,window.initHomePage=Nt,window.initContactsPage=Ft,window.initVacanciesPage=Rt,window.initPaymentsPage=Ht,window.Pagination=ge,window.initServiceActsPage=un,window.initSendersReceiversPage=hn;let pn=!1,je=!1;function Po(){console.log("=== Начало инициализации страницы ==="),Pt(),qt(),new et,document.getElementById("map")&&(console.log("Найден контейнер карты, начинаем инициализацию..."),setTimeout(()=>{let a=[];const o=document.querySelectorAll(".office-card");let i=!1;if(o&&o.length>0&&(console.log("Найдены карточки офисов на странице:",o.length),o.forEach(r=>{if(r.dataset.coordinates){const s=r.dataset.coordinates.split(",").map(l=>parseFloat(l.trim()));if(s.length===2){const l=r.dataset.city||"",d=r.querySelector("h3 + div.text-brand-gray"),u=d?d.textContent.trim():"",h=r.querySelectorAll("div.text-brand-gray"),c=h.length>1?h[1]:null,m=h.length>2?h[2]:null,f=h.length>3?h[3]:null;a.push({city:l,address:u,type:c?c.textContent.trim():"",phone:m?m.textContent.trim():"",email:f?f.textContent.trim():"",coordinates:s})}}}),a.length>0&&(console.log("Собраны данные офисов из карточек:",a.length),te(a),i=!0)),!i&&window.officesData&&window.officesData.length>0&&(console.log("Использую предварительно загруженные данные офисов:",window.officesData.length),te(window.officesData),i=!0),!i){const r=document.querySelector(".map-info-panel .font-bold.text-2xl.text-brand-gray");if(r){console.log("Найдены данные для дефолтного офиса в DOM");const s=document.querySelector(".map-info-panel div:nth-of-type(2)"),l=document.querySelector(".map-info-panel div:nth-of-type(3)"),d=document.querySelector(".map-info-panel div:nth-of-type(4)"),u=document.querySelector(".map-info-panel div:nth-of-type(5)");let h=[56.010563,92.852572];const c=document.querySelector(".map-info-panel");if(c&&c.dataset.coordinates){const y=c.dataset.coordinates.split(",").map(E=>parseFloat(E.trim()));y.length===2&&(h=y)}const m={city:r.textContent,address:s?s.textContent:"",type:l?l.textContent:"",phone:d?d.textContent:"",email:u?u.textContent:"",coordinates:h};te([m])}else console.log("Данные не найдены на странице, инициализируем карту без маркеров"),te([])}},100));const t=window.location.pathname,n=t.split("/").pop();console.log(`Текущий путь: ${t}, определена страница: ${n||"главная (индекс)"}`),n===""||n==="index.html"?(console.log("Инициализация главной страницы..."),Nt()):n==="vacancies.html"?(console.log("Инициализация страницы вакансий..."),Rt()):n==="contacts.html"?(console.log("Инициализация страницы контактов..."),Ft()):n==="payments.html"?(console.log("Инициализация страницы платежей..."),Ht()):n==="news.html"?(console.log("Инициализация страницы новостей..."),new io):n==="service-acts.html"?(console.log("Инициализация страницы актов оказания услуг..."),un()):n==="senders-receivers.html"&&(console.log("Инициализация страницы карточек отправителей и получателей..."),hn()),At(),Ja(),console.log("=== Инициализация страницы завершена ===")}function vn(){if(pn||je){console.log("Инициализация уже выполнена или в процессе, пропускаем повторный вызов");return}console.log("Начинаем безопасную инициализацию страницы"),je=!0;try{Po(),pn=!0}catch(e){console.error("Ошибка при инициализации страницы:",e)}finally{je=!1}}Xe(vn),(document.readyState==="interactive"||document.readyState==="complete")&&(console.log("DOM уже загружен, вызываем инициализацию напрямую"),vn())})();
